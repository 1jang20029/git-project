<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공지사항 관리 - 연성대학교</title>
    <link rel="stylesheet" href="admin-notices.css">
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <header class="header">
            <button class="back-btn" onclick="goBack()">
                <span>←</span>
            </button>
            <h1 class="header-title" id="headerTitle">공지사항 작성</h1>
            <div class="header-actions">
                <button class="header-btn" onclick="saveDraft()" id="draftBtn">
                    <span>💾</span> 임시저장
                </button>
                <button class="header-btn primary" onclick="publishNotice()" id="publishBtn">
                    <span>📢</span> 게시
                </button>
            </div>
        </header>

        <!-- 권한 확인 -->
        <div class="permission-check">
            <div class="user-info">
                <div>
                    <span class="user-role" id="userRole">사용자</span>
                    <span id="userDepartment" style="margin-left: 8px; color: #666;"></span>
                </div>
                <div id="currentTime" style="font-size: 12px; color: #666;"></div>
            </div>
            <div class="permission-warning" id="permissionWarning">
                교수 및 교직원만 공지사항을 작성할 수 있습니다.
            </div>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="tab-navigation">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('write')" id="writeTab">
                    ✏️ 새 공지 작성
                </button>
                <button class="tab-btn" onclick="switchTab('manage')" id="manageTab">
                    📋 내 공지 관리
                </button>
            </div>
        </div>

        <!-- 작성 탭 -->
        <div class="tab-content active" id="writeContent">
            <form class="write-form" id="noticeForm">
                <!-- 기본 정보 -->
                <div class="form-section">
                    <div class="section-title">
                        📝 기본 정보 <span class="required">*</span>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">카테고리 <span class="required">*</span></label>
                                <select class="form-select" id="category" required>
                                    <option value="">카테고리를 선택하세요</option>
                                    <option value="academic">📚 학사</option>
                                    <option value="scholarship">💰 장학</option>
                                    <option value="job">💼 취업</option>
                                    <option value="event">🎉 행사</option>
                                    <option value="department">🏢 학과</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-col small">
                            <div class="form-group">
                                <label class="form-label">게시일</label>
                                <input type="date" class="form-input" id="publishDate" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">제목 <span class="required">*</span></label>
                        <input type="text" class="form-input" id="title" placeholder="공지사항 제목을 입력하세요" required maxlength="100">
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            <span id="titleCount">0</span>/100
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">요약 <span class="required">*</span></label>
                        <textarea class="form-textarea" id="summary" placeholder="공지사항의 간단한 요약을 입력하세요" required maxlength="200"></textarea>
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            <span id="summaryCount">0</span>/200
                        </div>
                    </div>
                </div>

                <!-- 내용 -->
                <div class="form-section">
                    <div class="section-title">
                        📄 내용 <span class="required">*</span>
                    </div>
                    
                    <div class="form-group">
                        <textarea class="form-textarea content-textarea" id="content" placeholder="공지사항의 상세 내용을 입력하세요" required></textarea>
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            글자 수: <span id="contentCount">0</span>
                        </div>
                    </div>
                </div>

                <!-- 옵션 설정 -->
                <div class="form-section">
                    <div class="section-title">
                        ⚙️ 옵션 설정
                    </div>
                    
                    <div class="important-switch">
                        <label class="switch">
                            <input type="checkbox" id="important">
                            <span class="slider"></span>
                        </label>
                        <div>
                            <strong>중요 공지로 설정</strong>
                            <div style="font-size: 12px; color: #666;">중요 공지는 목록 상단에 고정되며 "중요" 배지가 표시됩니다.</div>
                        </div>
                    </div>
                </div>

                <!-- 대상 설정 -->
                <div class="form-section">
                    <div class="section-title">
                        🎯 대상 설정
                    </div>
                    
                    <div class="target-settings">
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="targetAll" name="target" value="all" checked>
                                <label for="targetAll">전체 공지</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="targetDepartment" name="target" value="department">
                                <label for="targetDepartment">특정 학과</label>
                            </div>
                        </div>
                        
                        <div class="department-grid" id="departmentGrid" style="display: none;">
                            <div class="checkbox-item">
                                <input type="checkbox" id="dept_computer" value="computerScience">
                                <label for="dept_computer">컴퓨터정보학과</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dept_business" value="business">
                                <label for="dept_business">경영학과</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dept_nursing" value="nursing">
                                <label for="dept_nursing">간호학과</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dept_engineering" value="engineering">
                                <label for="dept_engineering">공학계열</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dept_arts" value="arts">
                                <label for="dept_arts">예술계열</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 버튼 그룹 -->
                <div class="btn-group">
                    <button type="button" class="btn btn-outline" onclick="previewNotice()">
                        <span>👁</span> 미리보기
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                        <span>💾</span> 임시저장
                    </button>
                    <button type="button" class="btn btn-primary" onclick="publishNotice()">
                        <span>📢</span> 게시하기
                    </button>
                </div>
            </form>
        </div>

        <!-- 관리 탭 -->
        <div class="tab-content" id="manageContent">
            <div class="manage-filters">
                <div class="filter-group">
                    <select class="form-select" id="statusFilter" onchange="filterMyNotices()">
                        <option value="all">전체 상태</option>
                        <option value="published">게시됨</option>
                        <option value="draft">임시저장</option>
                    </select>
                    <select class="form-select" id="categoryFilter" onchange="filterMyNotices()">
                        <option value="all">전체 카테고리</option>
                        <option value="academic">학사</option>
                        <option value="scholarship">장학</option>
                        <option value="job">취업</option>
                        <option value="event">행사</option>
                        <option value="department">학과</option>
                    </select>
                </div>
                <div class="filter-group">
                    <span id="noticeCountDisplay">총 0건</span>
                </div>
            </div>

            <div class="notice-list" id="myNoticesList">
                <!-- 동적으로 생성됨 -->
            </div>
        </div>

        <!-- 미리보기 모달 -->
        <div id="previewModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 600px; max-height: 80%; overflow-y: auto; background: white; border-radius: 12px;">
                <div style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <h3>미리보기</h3>
                    <button onclick="closePreview()" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                </div>
                <div style="padding: 20px;">
                    <div id="previewContent">
                        <!-- 미리보기 내용 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="admin-notices.js"></script>
</body>
</html>