<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공지사항 관리 - 연성대학교</title>
    <link rel="stylesheet" href="admin-notices.css">
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <header class="header">
            <button class="back-button" onclick="goBack()">←</button>
            <h1 class="header-title">공지사항 관리</h1>
            <div class="header-right">
                <span class="user-role" id="userRole">교수</span>
            </div>
        </header>

        <!-- 탭 메뉴 -->
        <div class="tab-menu">
            <button class="tab-button active" data-tab="write" onclick="switchTab('write')">
                ✏️ 공지사항 작성
            </button>
            <button class="tab-button" data-tab="manage" onclick="switchTab('manage')">
                📋 내 공지사항 관리
            </button>
        </div>

        <!-- 공지사항 작성 탭 -->
        <div id="write-tab" class="tab-content active">
            <div class="write-container">
                <h2 class="section-title">새 공지사항 작성</h2>
                
                <!-- 권한 안내 -->
                <div id="permission-notice" class="permission-notice">
                    <span class="notice-icon">ℹ️</span>
                    <span id="permission-text">교수 권한으로 학과 공지사항을 작성할 수 있습니다.</span>
                </div>

                <form id="noticeForm" class="notice-form">
                    <!-- 기본 정보 -->
                    <div class="form-section">
                        <h3>기본 정보</h3>
                        
                        <div class="form-group">
                            <label class="form-label">카테고리 *</label>
                            <select class="form-input" id="category" required>
                                <option value="">카테고리를 선택하세요</option>
                                <!-- 권한에 따라 동적으로 생성 -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">제목 *</label>
                            <input type="text" class="form-input" id="title" placeholder="공지사항 제목을 입력하세요" required maxlength="100">
                            <div class="char-count">
                                <span id="title-count">0</span>/100자
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">요약 (미리보기용)</label>
                            <textarea class="form-input" id="summary" placeholder="공지사항의 간단한 요약을 입력하세요 (선택사항)" rows="2" maxlength="200"></textarea>
                            <div class="char-count">
                                <span id="summary-count">0</span>/200자
                            </div>
                        </div>
                    </div>

                    <!-- 내용 -->
                    <div class="form-section">
                        <h3>내용</h3>
                        <div class="form-group">
                            <label class="form-label">공지사항 내용 *</label>
                            <textarea class="form-input content-textarea" id="content" placeholder="공지사항 내용을 자세히 입력하세요" required rows="10"></textarea>
                        </div>
                    </div>

                    <!-- 고급 설정 -->
                    <div class="form-section">
                        <h3>게시 설정</h3>
                        
                        <div class="form-group">
                            <label class="form-label">중요도</label>
                            <div class="radio-group">
                                <label class="radio-item">
                                    <input type="radio" name="importance" value="normal" checked>
                                    <span>일반</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="importance" value="important">
                                    <span>중요</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="importance" value="urgent">
                                    <span>긴급</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">대상 학과</label>
                            <select class="form-input" id="targetAudience">
                                <option value="전체">전체 학과</option>
                                <!-- 권한에 따라 동적으로 생성 -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">게시 기간</label>
                            <div class="date-range">
                                <input type="date" class="form-input date-input" id="publishDate">
                                <span>~</span>
                                <input type="date" class="form-input date-input" id="expireDate">
                            </div>
                            <div class="form-hint">설정하지 않으면 즉시 게시되며 만료되지 않습니다.</div>
                        </div>
                    </div>

                    <!-- 버튼 -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">임시저장</button>
                        <button type="button" class="btn btn-primary" onclick="previewNotice()">미리보기</button>
                        <button type="submit" class="btn btn-primary">게시하기</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- 공지사항 관리 탭 -->
        <div id="manage-tab" class="tab-content">
            <div class="manage-container">
                <div class="manage-header">
                    <h2 class="section-title">내 공지사항 관리</h2>
                    <div class="manage-controls">
                        <select class="filter-select" id="statusFilter" onchange="filterNotices()">
                            <option value="all">전체</option>
                            <option value="published">게시중</option>
                            <option value="draft">임시저장</option>
                            <option value="expired">만료됨</option>
                        </select>
                        <button class="btn btn-small" onclick="refreshManageList()">새로고침</button>
                    </div>
                </div>

                <!-- 공지사항 목록 -->
                <div id="manage-list" class="manage-list">
                    <div class="loading-indicator">
                        <div class="loading-spinner"></div>
                        <p>공지사항을 불러오는 중...</p>
                    </div>
                </div>

                <!-- 빈 상태 -->
                <div id="empty-state" class="empty-state" style="display: none;">
                    <div class="empty-icon">📝</div>
                    <h3>작성한 공지사항이 없습니다</h3>
                    <p>새로운 공지사항을 작성해보세요.</p>
                    <button class="btn btn-primary" onclick="switchTab('write')">공지사항 작성하기</button>
                </div>
            </div>
        </div>

        <!-- 미리보기 모달 -->
        <div id="preview-modal" class="modal">
            <div class="modal-overlay" onclick="closePreview()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>공지사항 미리보기</h3>
                    <button class="close-btn" onclick="closePreview()">×</button>
                </div>
                <div class="modal-body">
                    <div id="preview-content" class="preview-content">
                        <!-- 미리보기 내용이 여기에 표시됩니다 -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closePreview()">닫기</button>
                    <button class="btn btn-primary" onclick="submitNotice()">게시하기</button>
                </div>
            </div>
        </div>

        <!-- 편집 모달 -->
        <div id="edit-modal" class="modal">
            <div class="modal-overlay" onclick="closeEditModal()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>공지사항 수정</h3>
                    <button class="close-btn" onclick="closeEditModal()">×</button>
                </div>
                <div class="modal-body">
                    <!-- 편집 폼이 여기에 복사됩니다 -->
                    <div id="edit-form-container"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeEditModal()">취소</button>
                    <button class="btn btn-primary" onclick="updateNotice()">수정 완료</button>
                </div>
            </div>
        </div>
    </div>

    <script src="admin-notices.js"></script>
</body>
</html>