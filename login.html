    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ë¡œê·¸ì¸ - ì—°ì„±ëŒ€í•™êµ</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
            }
            
            body {
                background-color: #f5f5f5;
                color: #333;
            }
            
            .container {
                max-width: 768px;
                margin: 0 auto;
                background-color: white;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }
            
            header {
                background-color: #c62917;
                color: white;
                padding: 12px 16px;
                display: flex;
                align-items: center;
            }
            
            .back-button {
                font-size: 20px;
                margin-right: 16px;
                cursor: pointer;
            }
            
            .header-title {
                font-size: 18px;
                font-weight: bold;
            }
            
            .login-container {
                padding: 32px 24px;
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            
            .logo-container {
                text-align: center;
                margin-bottom: 40px;
            }
            
            .university-logo {
                font-size: 24px;
                font-weight: bold;
                color: #c62917;
                margin-bottom: 8px;
            }
            
            .slogan {
                font-size: 16px;
                color: #666;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            .form-label {
                display: block;
                font-size: 14px;
                color: #555;
                margin-bottom: 8px;
            }
            
            .form-input {
                width: 100%;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                font-size: 16px;
            }
            
            .form-input:focus {
                border-color: #c62917;
                outline: none;
            }
            
            .login-button {
                width: 100%;
                padding: 14px;
                background-color: #c62917;
                color: white;
                border: none;
                border-radius: 4px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                margin-top: 16px;
            }
            
            .login-options {
                display: flex;
                justify-content: space-between;
                font-size: 14px;
                color: #666;
                margin-top: 16px;
            }
            
            .login-options a {
                color: #666;
                text-decoration: none;
            }
            
            .separator {
                display: flex;
                align-items: center;
                margin: 32px 0;
                color: #888;
            }
            
            .separator-line {
                flex: 1;
                height: 1px;
                background-color: #ddd;
            }
            
            .separator-text {
                padding: 0 16px;
                font-size: 14px;
            }
            
            .social-login {
                display: flex;
                justify-content: center;
                gap: 16px;
            }
            
            .social-button {
                width: 48px;
                height: 48px;
                border-radius: 24px;
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 20px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.2s ease;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                text-decoration: none;
            }
            
            .social-button:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            }
            
            .naver-button {
                background-color: #03C75A;
                color: white;
            }
            
            .kakao-button {
                background-color: #FEE500;
                color: #3A1D1D;
            }
            
            .google-button {
                background-color: white;
                color: #4285F4;
                border: 1px solid #ddd;
            }
            
            .register-link {
                text-align: center;
                margin-top: 32px;
                font-size: 14px;
                color: #666;
            }
            
            .register-link a {
                color: #c62917;
                font-weight: bold;
                text-decoration: none;
            }
            
            /* ë„¤ì´ë²„ ë¡œê·¸ì¸ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
            .modal {
                display: none;
                position: fixed;
                z-index: 1000;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                overflow: auto;
                background-color: rgba(0,0,0,0.4);
                animation: fadeIn 0.3s;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            .modal-content {
                background-color: #fefefe;
                margin: 10% auto;
                padding: 0;
                width: 90%;
                max-width: 400px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideDown 0.3s;
                overflow: hidden;
            }
            
            @keyframes slideDown {
                from { transform: translateY(-50px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            
            .modal-header {
                background-color: #03C75A;
                color: white;
                padding: 16px 20px;
                position: relative;
            }
            
            .modal-title {
                font-size: 18px;
                font-weight: bold;
                display: flex;
                align-items: center;
            }
            
            .modal-title:before {
                content: "N";
                display: flex;
                justify-content: center;
                align-items: center;
                width: 28px;
                height: 28px;
                background-color: white;
                color: #03C75A;
                border-radius: 50%;
                margin-right: 10px;
                font-weight: bold;
            }
            
            .close-modal {
                position: absolute;
                right: 16px;
                top: 50%;
                transform: translateY(-50%);
                color: white;
                font-size: 24px;
                font-weight: bold;
                cursor: pointer;
                opacity: 0.8;
                transition: opacity 0.2s;
            }
            
            .close-modal:hover {
                opacity: 1;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .modal-form-group {
                margin-bottom: 16px;
                position: relative;
            }
            
            .modal-form-group .form-label {
                color: #333;
                font-weight: 500;
            }
            
            .modal-form-group .form-input {
                border: 1px solid #ddd;
                background-color: #f9f9f9;
                transition: all 0.3s;
            }
            
            .modal-form-group .form-input:focus {
                border-color: #03C75A;
                background-color: white;
                box-shadow: 0 0 0 2px rgba(3, 199, 90, 0.2);
            }
            
            .input-icon {
                position: absolute;
                right: 12px;
                top: 38px;
                color: #aaa;
            }
            
            .modal-footer {
                padding: 16px 20px;
                background-color: #f5f5f5;
                text-align: right;
                border-top: 1px solid #eee;
            }
            
            .modal-button {
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 14px;
                font-weight: bold;
                transition: all 0.2s;
            }
            
            .modal-button.cancel {
                background-color: #eee;
                color: #666;
                margin-right: 10px;
            }
            
            .modal-button.cancel:hover {
                background-color: #ddd;
            }
            
            .modal-button.login {
                background-color: #03C75A;
                color: white;
            }
            
            .modal-button.login:hover {
                background-color: #02b050;
            }
            
            .naver-benefits {
                margin-top: 16px;
                background-color: #f5f9f7;
                padding: 12px;
                border-radius: 4px;
                font-size: 13px;
                color: #555;
                line-height: 1.5;
            }
            
            .benefits-title {
                font-weight: bold;
                margin-bottom: 6px;
                color: #03C75A;
            }
            
            /* ìë™ ì…ë ¥ ì²´í¬ë°•ìŠ¤ */
            .auto-login {
                display: flex;
                align-items: center;
                margin-top: 12px;
            }
            
            .auto-login input {
                margin-right: 8px;
            }
            
            .auto-login label {
                font-size: 13px;
                color: #666;
            }
            
            /* ì €ì¥ì†Œ ì ‘ê·¼ ê´€ë ¨ ì•Œë¦¼ */
            .storage-notice {
                background-color: #fffde7;
                border: 1px solid #fff9c4;
                border-radius: 4px;
                padding: 8px 12px;
                font-size: 13px;
                color: #5d4037;
                margin-bottom: 15px;
                display: none;
            }


            /* ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
            .password-input-container {
                position: relative;
                width: 100%;
            }

            /* ë¹„ë°€ë²ˆí˜¸ í† ê¸€ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
            .password-toggle {
                position: absolute;
                right: 12px;
                top: 50%;
                transform: translateY(-50%);
                cursor: pointer;
                font-size: 18px;
                color: #888;
                user-select: none;
            }

            .password-toggle:hover {
                color: #c62917;
            }

            /* ëˆˆ ì•„ì´ì½˜ì´ ìˆëŠ” ê²½ìš° íŒ¨ë”© ì¡°ì • */
            .password-input-container .form-input {
                padding-right: 40px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
                <div class="back-button" onclick="goBack()">â†</div>
                <div class="header-title">ë¡œê·¸ì¸</div>
            </header>
            
            <div class="login-container">
                <div id="storage-notice" class="storage-notice">
                    ë¯¸ë¦¬ë³´ê¸° í™˜ê²½ì—ì„œëŠ” ë°ì´í„° ì €ì¥ ê¸°ëŠ¥ì´ ì œí•œë©ë‹ˆë‹¤. ì‹¤ì œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•´ì£¼ì„¸ìš”.
                </div>
                
                <div class="logo-container">
                    <div class="university-logo">ì—°ì„±ëŒ€í•™êµ</div>
                    <div class="slogan">Campus Guide</div>
                </div>
                
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label">ì•„ì´ë”” (í•™ë²ˆ)</label>
                        <input type="text" class="form-input" id="studentId" placeholder="í•™ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                        <div class="password-input-container">
                            <input type="password" class="form-input" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                            <span class="password-toggle" id="passwordToggle">ğŸ‘ï¸â€ğŸ—¨ï¸</span>
                        </div>
                    </div>
                    
                    <button type="button" class="login-button" onclick="login()">ë¡œê·¸ì¸</button>
                    
                    <div class="login-options">
                        <a href="find-id.html">ì•„ì´ë”” ì°¾ê¸°</a>
                        <a href="find-password.html">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
                    </div>
                </form>
                
                <div class="separator">
                    <div class="separator-line"></div>
                    <div class="separator-text">ë˜ëŠ”</div>
                    <div class="separator-line"></div>
                </div>
                
                <div class="social-login">
                    <div class="social-button naver-button" onclick="naverLogin()">N</div>
                    <a href="https://kauth.kakao.com/oauth/authorize?client_id=beed5990dc19ffd7ab4f2355afa70129&redirect_uri=https://ysu-guide.netlify.app/kakao-callback.html&response_type=code&prompt=login" class="social-button kakao-button">K</a>
                    <div class="social-button google-button" onclick="googleLogin()">G</div>
                </div>
                
                <div class="register-link">
                    ì•„ì§ ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <a href="register.html">íšŒì›ê°€ì…</a>
                </div>
            </div>
        </div>
        
        <!-- ë„¤ì´ë²„ ë¡œê·¸ì¸ ëª¨ë‹¬ -->
        <div id="naverLoginModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">ë„¤ì´ë²„ ë¡œê·¸ì¸</div>
                    <span class="close-modal" onclick="closeModal('naverLoginModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="modal-form-group">
                        <label class="form-label">ë„¤ì´ë²„ ì•„ì´ë””</label>
                        <input type="text" class="form-input" id="naverId" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                        <span class="input-icon">ğŸ‘¤</span>
                    </div>
                    <div class="modal-form-group">
                        <label class="form-label">ë„¤ì´ë²„ ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" class="form-input" id="naverPw" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                        <span class="input-icon">ğŸ”’</span>
                    </div>
                    
                    <div class="auto-login">
                        <input type="checkbox" id="autoLogin">
                        <label for="autoLogin">ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€</label>
                    </div>
                    
                    <div class="naver-benefits">
                        <div class="benefits-title">ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œ í˜œíƒ</div>
                        <ul>
                            <li>ë„¤ì´ë²„ ìº˜ë¦°ë”ì™€ í•™ì‚¬ì¼ì • ì—°ë™</li>
                            <li>ë„¤ì´ë²„ ì§€ë„ë¡œ ìº í¼ìŠ¤ ê±´ë¬¼ ì°¾ê¸°</li>
                            <li>ë„¤ì´ë²„ ë©”ì¼ì„ í†µí•œ ì•Œë¦¼ ìˆ˜ì‹ </li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="modal-button cancel" onclick="closeModal('naverLoginModal')">ì·¨ì†Œ</button>
                    <button class="modal-button login" onclick="processNaverLogin()">ë¡œê·¸ì¸</button>
                </div>
            </div>
        </div>
        
        <script>
            // localStorage ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸ í•¨ìˆ˜
            function isLocalStorageAvailable() {
                try {
                    const test = 'test';
                    localStorage.setItem(test, test);
                    localStorage.removeItem(test);
                    return true;
                } catch (e) {
                    console.error('localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', e);
                    return false;
                }
                
                return false;
            }
            
            // ì•ˆì „í•œ ìŠ¤í† ë¦¬ì§€ ê°ì²´
            const safeStorage = {
                memoryStorage: {},
                
                setItem: function(key, value) {
                    try {
                        localStorage.setItem(key, value);
                    } catch (e) {
                        console.warn('localStorageë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ ë©”ëª¨ë¦¬ì— ì €ì¥í•©ë‹ˆë‹¤:', e);
                        this.memoryStorage[key] = value;
                        document.getElementById('storage-notice').style.display = 'block';
                    }
                },
                
                getItem: function(key) {
                    try {
                        const value = localStorage.getItem(key);
                        return value;
                    } catch (e) {
                        console.warn('localStorageì— ì ‘ê·¼í•  ìˆ˜ ì—†ì–´ ë©”ëª¨ë¦¬ì—ì„œ ì¡°íšŒí•©ë‹ˆë‹¤:', e);
                        return this.memoryStorage[key] || null;
                    }
                },
                
                removeItem: function(key) {
                    try {
                        localStorage.removeItem(key);
                    } catch (e) {
                        console.warn('localStorageì—ì„œ ì‚­ì œí•  ìˆ˜ ì—†ì–´ ë©”ëª¨ë¦¬ì—ì„œ ì‚­ì œí•©ë‹ˆë‹¤:', e);
                        delete this.memoryStorage[key];
                    }
                }
            };
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— íšŒì›ê°€ì… ì—¬ë¶€ ì €ì¥
            function saveRegistrationStatus(studentId) {
                safeStorage.setItem(`user_${studentId}_registered`, 'true');
                // ìµœì´ˆ ë¡œê·¸ì¸ ìƒíƒœë¥¼ trueë¡œ ì„¤ì • (ì•„ì§ ë¡œê·¸ì¸í•œ ì  ì—†ìŒ)
                safeStorage.setItem(`user_${studentId}_first_login`, 'true');
            }


            // íšŒì›ê°€ì… ì‹œ ì‚¬ìš©ì ì •ë³´ ì €ì¥ í•¨ìˆ˜ (register.html íŒŒì¼ì— í•„ìš”)
            function registerUser(studentId, password, name, department, grade, email, phone) {
                // íšŒì› ì •ë³´ ì €ì¥
                safeStorage.setItem(`user_${studentId}_registered`, 'true');
                safeStorage.setItem(`user_${studentId}_password`, password);
                safeStorage.setItem(`user_${studentId}_name`, name);
                safeStorage.setItem(`user_${studentId}_department`, department);
                safeStorage.setItem(`user_${studentId}_grade`, grade);
                safeStorage.setItem(`user_${studentId}_email`, email);
                safeStorage.setItem(`user_${studentId}_phone`, phone);
                
                // ìµœì´ˆ ë¡œê·¸ì¸ ìƒíƒœë¥¼ trueë¡œ ì„¤ì •
                safeStorage.setItem(`user_${studentId}_first_login`, 'true');
                
                // íšŒì›ê°€ì… ì™„ë£Œ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜
                window.location.href = `login.html?newRegistration=true&studentId=${studentId}`;
            }
            
            // ë’¤ë¡œê°€ê¸° í•¨ìˆ˜
            function goBack() {
                window.location.href = "index.html";
            }
            
            // ì¼ë°˜ ë¡œê·¸ì¸ ì²˜ë¦¬ í•¨ìˆ˜
            function login() {
                const studentId = document.getElementById('studentId').value;
                const password = document.getElementById('password').value;
                
                // ê°„ë‹¨í•œ ìœ íš¨ì„± ê²€ì‚¬
                if (!studentId || !password) {
                    alert('í•™ë²ˆê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // íšŒì›ê°€ì… ì—¬ë¶€ í™•ì¸
                const isRegistered = localStorage.getItem(`user_${studentId}_registered`) === 'true';
                
                if (!isRegistered) {
                    alert('ë“±ë¡ë˜ì§€ ì•Šì€ í•™ë²ˆì…ë‹ˆë‹¤. íšŒì›ê°€ì…ì„ ë¨¼ì € ì§„í–‰í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
                const storedPassword = localStorage.getItem(`user_${studentId}_password`);
                
                if (password !== storedPassword) {
                    alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    return;
                }
                
                // í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì €ì¥
                localStorage.setItem('currentLoggedInUser', studentId);
                
                // ìµœì´ˆ ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
                const isFirstLogin = localStorage.getItem(`user_${studentId}_first_login`) === 'true';
                
                if (isFirstLogin) {
                    // ìµœì´ˆ ë¡œê·¸ì¸ì¸ ê²½ìš° ìœ„ì ¯ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™
                    localStorage.setItem(`user_${studentId}_first_login`, 'false');
                    alert('ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìœ„ì ¯ ë° ë©”ë‰´ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                    window.location.href = "widget-settings.html";
                } else {
                    // ìµœì´ˆ ë¡œê·¸ì¸ì´ ì•„ë‹Œ ê²½ìš° ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
                    alert('ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    window.location.href = "index.html";
                }
            }


        
            // URL íŒŒë¼ë¯¸í„°ì—ì„œ ìƒˆë¡œ íšŒì›ê°€ì…í–ˆëŠ”ì§€ í™•ì¸
            function checkNewRegistration() {
                // localStorage ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
                if (!isLocalStorageAvailable()) {
                    document.getElementById('storage-notice').style.display = 'block';
                }
            
                const urlParams = new URLSearchParams(window.location.search);
                const newRegistration = urlParams.get('newRegistration');
                const studentId = urlParams.get('studentId');
            
                if (newRegistration === 'true' && studentId) {
                    // ìƒˆë¡œ íšŒì›ê°€ì…í•œ ê²½ìš° íšŒì›ê°€ì… ìƒíƒœ ì €ì¥
                    saveRegistrationStatus(studentId);
                
                    // í•™ë²ˆ ìë™ ì…ë ¥
                    document.getElementById('studentId').value = studentId;
                
                    // í¬ì»¤ìŠ¤ë¥¼ ë¹„ë°€ë²ˆí˜¸ í•„ë“œë¡œ ì´ë™
                    document.getElementById('password').focus();
                }
            }
        
            // ë„¤ì´ë²„ ë¡œê·¸ì¸ ëª¨ë‹¬ ì—´ê¸°
            function naverLogin() {
                // ë„¤ì´ë²„ ë¡œê·¸ì¸ API ì‚¬ìš© - ì‹¤ì œ ë„¤ì´ë²„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
                const CLIENT_ID = '4s_r7FMu5Bfr3er3GXci'; // ì´ë¯¸ì§€ì—ì„œ ë³´ì´ëŠ” í´ë¼ì´ì–¸íŠ¸ ID
                const REDIRECT_URI = 'https://ysu-guide.netlify.app/naver-callback.html';
                const STATE = Math.random().toString(36).substr(2, 11);
            
                // ìƒíƒœ í† í° ì €ì¥ (CSRF ë°©ì§€)
                safeStorage.setItem('naverOAuthState', STATE);
            
                // ë„¤ì´ë²„ OAuth 2.0 ì¸ì¦ URL ìƒì„±
                const authUrl = 'https://nid.naver.com/oauth2.0/authorize?' +
                    'client_id=' + CLIENT_ID +
                    '&response_type=code' +
                    '&redirect_uri=' + encodeURIComponent(REDIRECT_URI) +
                    '&state=' + STATE;
                
                // ë„¤ì´ë²„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
                window.location.href = authUrl;
            }
        
            // ëª¨ë‹¬ ë‹«ê¸°
            function closeModal(modalId) {
                document.getElementById(modalId).style.display = 'none';
            }
        
            // ëª¨ë‹¬ ì´ë²¤íŠ¸ ì„¤ì •
            function setupModalEvents() {
                const modal = document.getElementById('naverLoginModal');
                const modalContent = modal.querySelector('.modal-content');
                
                // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸° (ë‹¨, ì…ë ¥ ì¤‘ì¼ ë•ŒëŠ” ì˜ˆì™¸)
                window.onclick = function(event) {
                    if (event.target === modal) {
                        // ì•„ì´ë””ë‚˜ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì¤‘ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ëª¨ë‹¬ ë‹«ê¸°
                        const naverId = document.getElementById('naverId');
                        const naverPw = document.getElementById('naverPw');
                        
                        if (document.activeElement !== naverId && document.activeElement !== naverPw) {
                            modal.style.display = 'none';
                        }
                    }
                };
            
                // ì…ë ¥ í•„ë“œì—ì„œ í¬ì»¤ìŠ¤ê°€ ë‚˜ê°€ë„ ëª¨ë‹¬ì´ ìœ ì§€ë˜ë„ë¡ ì„¤ì •
                const inputFields = modal.querySelectorAll('input');
                inputFields.forEach(input => {
                    input.addEventListener('blur', function(e) {
                        e.stopPropagation();
                    });
                });
                
                // ëª¨ë‹¬ ë‚´ë¶€ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€
                modalContent.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
            }
            
            // ë„¤ì´ë²„ ëª¨ë‹¬ ë¡œê·¸ì¸ ì²˜ë¦¬
            function processNaverLogin() {
                const naverId = document.getElementById('naverId').value;
                const naverPw = document.getElementById('naverPw').value;
                const autoLogin = document.getElementById('autoLogin').checked;
                
                // ê°„ë‹¨í•œ ìœ íš¨ì„± ê²€ì‚¬
                if (!naverId || !naverPw) {
                    alert('ë„¤ì´ë²„ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                try {
                    // ì—¬ê¸°ì„œëŠ” ì„ì‹œë¡œ ì²˜ë¦¬ (ì‹¤ì œë¡œëŠ” ë„¤ì´ë²„ OAuth APIë¥¼ ì‚¬ìš©)
                    // ë„¤ì´ë²„ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì„ì‹œ í•™ë²ˆ ìƒì„±
                    const tempStudentId = 'naver_' + naverId;
                    
                    // ì‚¬ìš©ì ì •ë³´ ì €ì¥
                    safeStorage.setItem(`user_${tempStudentId}_registered`, 'true');
                    safeStorage.setItem(`user_${tempStudentId}_name`, 'ë„¤ì´ë²„ ì‚¬ìš©ì');
                    safeStorage.setItem(`user_${tempStudentId}_department`, 'computerScience');
                    safeStorage.setItem(`user_${tempStudentId}_grade`, '1');
                    safeStorage.setItem(`user_${tempStudentId}_email`, `${naverId}@naver.com`);
                    safeStorage.setItem(`user_${tempStudentId}_phone`, '010-0000-0000');
                    
                    // ìë™ ë¡œê·¸ì¸ ì„¤ì • ì €ì¥
                    if (autoLogin) {
                        safeStorage.setItem(`user_${tempStudentId}_autoLogin`, 'true');
                    }
                    
                    // í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì ì €ì¥
                    safeStorage.setItem('currentLoggedInUser', tempStudentId);
                    
                    // ì†Œì…œ ë¡œê·¸ì¸ ì‚¬ìš©ì í‘œì‹œ
                    safeStorage.setItem(`user_${tempStudentId}_socialType`, 'naver');
                    
                    // ìµœì´ˆ ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸ ë° ì„¤ì •
                    const isFirstLogin = safeStorage.getItem(`user_${tempStudentId}_first_login`) !== 'false';
                    if (isFirstLogin) {
                        safeStorage.setItem(`user_${tempStudentId}_first_login`, 'false');
                        
                        // ëª¨ë‹¬ ë‹«ê¸°
                        closeModal('naverLoginModal');
                        
                        alert('ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìœ„ì ¯ ë° ë©”ë‰´ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                        window.location.href = "widget-settings.html";
                    } else {
                        // ëª¨ë‹¬ ë‹«ê¸°
                        closeModal('naverLoginModal');
                        
                        alert('ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        window.location.href = "index.html";
                    }
                } catch (error) {
                    console.error('ë„¤ì´ë²„ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                    alert('ë„¤ì´ë²„ ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            }
            
            // êµ¬ê¸€ ë¡œê·¸ì¸ ì²˜ë¦¬ - ìƒˆ IDë¡œ ì—…ë°ì´íŠ¸
            function googleLogin() {
                // ìƒˆë¡œìš´ í´ë¼ì´ì–¸íŠ¸ ID ì‚¬ìš©
                const CLIENT_ID = '682526101032-6fpr7h5u93gkf762m0rkoj5bo5hpgs2u.apps.googleusercontent.com';
                
                // ë¦¬ë””ë ‰ì…˜ URI - ì´ ë¶€ë¶„ì€ ë³€ê²½í•˜ì§€ ì•ŠìŒ
                const REDIRECT_URI = 'https://ysu-guide.netlify.app/google-callback.html';
                
                // ê¶Œí•œ ë²”ìœ„ ìœ ì§€
                const SCOPE = 'email profile';
                
                // Google OAuth 2.0 ì¸ì¦ URL ìƒì„±
                const authUrl = 'https://accounts.google.com/o/oauth2/v2/auth?' +
                    'client_id=' + encodeURIComponent(CLIENT_ID) +
                    '&redirect_uri=' + encodeURIComponent(REDIRECT_URI) +
                    '&response_type=code' +
                    '&scope=' + encodeURIComponent(SCOPE) +
                    '&prompt=select_account' +
                    '&access_type=offline';
                
                // êµ¬ê¸€ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
                window.location.href = authUrl;
            }
            
            // ì—”í„° í‚¤ë¡œ ë¡œê·¸ì¸ ì²˜ë¦¬
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    const modal = document.getElementById('naverLoginModal');
                    
                    // ë„¤ì´ë²„ ë¡œê·¸ì¸ ëª¨ë‹¬ì´ ì—´ë ¤ìˆê³  ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤ê°€ ìˆì„ ë•Œ
                    if (modal.style.display === 'block') {
                        const naverId = document.getElementById('naverId');
                        const naverPw = document.getElementById('naverPw');
                        
                        if (document.activeElement === naverId || document.activeElement === naverPw) {
                            processNaverLogin();
                        }
                    }
                    // ì¼ë°˜ ë¡œê·¸ì¸ í¼ì—ì„œ ì—”í„°í‚¤ë¥¼ ëˆŒë €ì„ ë•Œ
                    else {
                        const studentId = document.getElementById('studentId');
                        const password = document.getElementById('password');
                        
                        if (document.activeElement === studentId || document.activeElement === password) {
                            login();
                        }
                    }
                }
            });
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
            document.addEventListener('DOMContentLoaded', checkNewRegistration);


            // ë¹„ë°€ë²ˆí˜¸ í‘œì‹œ/ìˆ¨ê¹€ í† ê¸€ ê¸°ëŠ¥
            document.addEventListener('DOMContentLoaded', function() {
                const passwordField = document.getElementById('password');
                const passwordToggle = document.getElementById('passwordToggle');
                
                if (passwordToggle) {
                    passwordToggle.addEventListener('click', function() {
                        // ë¹„ë°€ë²ˆí˜¸ í•„ë“œ íƒ€ì… ì „í™˜
                        const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                        passwordField.setAttribute('type', type);
                        
                        // ì•„ì´ì½˜ ë³€ê²½
                        if (type === 'text') {
                            // ë¹„ë°€ë²ˆí˜¸ ë³´ì„ ìƒíƒœ - ì—´ë¦° ëˆˆ
                            passwordToggle.textContent = 'ğŸ‘ï¸';
                        } else {
                            // ë¹„ë°€ë²ˆí˜¸ ìˆ¨ê¹€ ìƒíƒœ - ê°€ë ¤ì§„ ëˆˆ
                            passwordToggle.textContent = 'ğŸ‘ï¸â€ğŸ—¨ï¸';
                        }
                    });
                }
            });
        </script>
    </body>
</html>