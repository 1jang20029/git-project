<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>연성대학교 캠퍼스 가이드</title>
    <!-- 네이버 지도 API 스크립트 추가 - Direction 서브모듈 포함 -->
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=ikduyzmop9&submodules=direction"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 768px;
            margin: 0 auto;
            background-color: white;
            min-height: 100vh;
            padding-bottom: 60px; /* 하단 탭 메뉴 영역만큼 패딩 추가 */
            position: relative;
        }
        
        header {
            background-color: #c62917;
            color: white;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 20px;
            font-weight: bold;
        }
        
        .header-icons {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        
        .login-button {
            padding: 6px 12px;
            background-color: white;
            color: #c62917;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
        }
        
        .profile-dropdown-container {
            position: relative;
        }
        
        .header-profile-image {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            cursor: pointer;
        }
        
        .profile-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            width: 220px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            overflow: hidden;
            display: none;
        }
        
        .profile-dropdown.active {
            display: block;
        }
        
        .dropdown-profile-info {
            padding: 16px;
            background-color: #f9f9f9;
            border-bottom: 1px solid #eee;
        }
        
        .dropdown-profile-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 4px;
            color: #333;
        }
        
        .dropdown-profile-detail {
            font-size: 13px;
            color: #666;
            margin-bottom: 2px;
        }
        
        .dropdown-divider {
            height: 1px;
            background-color: #eee;
        }
        
        .dropdown-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            color: #666;
            cursor: pointer;
        }
        
        .dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .dropdown-icon {
            margin-right: 8px;
            font-size: 18px;
        }
        
        .search-bar {
            padding: 12px 16px;
            background-color: #f9f9f9;
            display: flex;
            border-bottom: 1px solid #eee;
        }
        
        .search-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* 검색 결과 스타일 */
        .search-results {
            background-color: white;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 0 16px;
            overflow: hidden;
            position: relative;
            z-index: 100;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .no-results {
            padding: 16px;
            text-align: center;
            color: #888;
            font-size: 14px;
        }
        
        .notification-banner {
            background-color: #ffebee;
            padding: 12px 16px;
            border-bottom: 1px solid #ffcdd2;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .urgent-icon {
            color: #c62917;
            font-weight: bold;
        }
        
        .notification-text {
            font-size: 14px;
            flex: 1;
        }
        
        .shortcut-menu {
            display: flex;
            padding: 16px;
            justify-content: space-between;
            border-bottom: 1px solid #eee;
        }
        
        .shortcut-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
            cursor: pointer;
        }
        
        .shortcut-icon {
            width: 40px;
            height: 40px;
            background-color: #f0f0f0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 8px;
            font-size: 20px;
        }
        
        .shortcut-text {
            font-size: 12px;
            text-align: center;
            color: #555;
        }
        
        .content-section {
            padding: 16px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .see-all {
            font-size: 13px;
            color: #888;
            text-decoration: none;
        }
        
        .notice-list {
            list-style: none;
        }
        
        .notice-item {
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        
        .notice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }
        
        .notice-category {
            background-color: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            color: #555;
        }
        
        .notice-date {
            font-size: 12px;
            color: #888;
        }
        
        .notice-title {
            font-size: 15px;
            margin-bottom: 6px;
        }
        
        .notice-summary {
            font-size: 13px;
            color: #666;
            line-height: 1.4;
        }
        
        .facility-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .facility-item {
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .facility-image {
            height: 100px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .facility-info {
            padding: 10px;
        }
        
        .facility-name {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .facility-location {
            font-size: 12px;
            color: #666;
        }
        
        .lecture-list {
            list-style: none;
        }
        
        .lecture-item {
            padding: 12px;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
        }
        
        .lecture-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .lecture-title {
            font-size: 15px;
            font-weight: bold;
        }
        
        .lecture-rating {
            color: #ff9800;
            font-weight: bold;
        }
        
        .lecture-info {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
        
        .lecture-professor {
            color: #333;
        }
        
        .lecture-reviews {
            font-size: 12px;
            color: #666;
        }
        
        /* 하단 탭 메뉴 수정 - 항상 표시되도록 */
        .tab-menu {
            display: flex;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 768px;
            margin: 0 auto;
            background-color: white;
            border-top: 1px solid #ddd;
            z-index: 1000; /* 다른 요소 위에 표시되도록 z-index 추가 */
            box-shadow: 0 -2px 5px rgba(0,0,0,0.05); /* 약간의 그림자 추가 */
        }
        
        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 0;
            font-size: 12px;
            color: #888;
            text-decoration: none;
            cursor: pointer;
        }
        
        .tab-item.active {
            color: #c62917;
        }
        
        .tab-icon {
            font-size: 22px;
            margin-bottom: 4px;
        }
        
        /* 지도 컨테이너 스타일 수정 */
        .campus-map {
            height: 350px; /* 높이 고정 */
            width: 100%;   /* 너비 100% */
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            margin: 16px 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            /* 추가: 컨테이너가 축소되지 않도록 패딩 및 마진 제거 */
            padding: 0;
            box-sizing: border-box;
        }
        
        /* 추가: 지도를 가리는 요소들 제거 */
        .campus-map > div:not(#naverMap):not(.map-control-buttons):not(.gps-button):not(.route-loading):not(.route-info-box) {
            display: none;
        }
        
        .campus-map img {
            max-width: 100%;
            max-height: 100%;
        }
        
        /* 지도 마커 정보창 스타일 */
        .map-info-window {
            padding: 8px 12px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            font-size: 13px;
            max-width: 200px;
        }
        
        .map-info-title {
            font-weight: bold;
            margin-bottom: 4px;
            color: #333;
        }
        
        .map-info-desc {
            color: #666;
            font-size: 12px;
        }
        
        /* 지도 버튼 스타일 */
        .map-control-buttons {
            position: absolute;
            bottom: 10px;
            right: 10px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .map-button {
            padding: 8px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            cursor: pointer;
        }
        
        .content-pad {
            padding-bottom: 60px; /* 하단 탭 메뉴 높이만큼 여백 */
        }

        /* 탭 콘텐츠 */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* 건물 및 교실 목록 */
        .building-list {
            list-style: none;
        }
        
        /* 건물 목록 항목 재디자인 */
        .building-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .building-image {
            width: 80px;
            height: 60px;
            border-radius: 4px;
            overflow: hidden;
            margin-right: 12px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .building-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .building-info-container {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .building-info {
            flex: 1;
        }
        
        .building-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .building-description {
            font-size: 13px;
            color: #666;
        }
        
        .building-nav-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            padding: 8px;
            border-radius: 4px;
            margin-left: 8px;
            cursor: pointer;
        }
        
        .building-nav-button:hover {
            background-color: #e0e0e0;
        }
        
        .building-nav-button span:first-child {
            font-size: 12px;
            color: #555;
            margin-bottom: 4px;
        }
        
        .building-nav-button span:last-child {
            font-size: 18px;
        }
        
        /* 강의 평가 스타일 */
        .rating-stars {
            color: #ffb400;
            letter-spacing: 2px;
        }
        
        /* 카테고리 필터 */
        .category-filter {
            display: flex;
            overflow-x: auto;
            padding: 8px 0;
            margin-bottom: 12px;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-tag {
            flex-shrink: 0;
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 16px;
            margin-right: 8px;
            font-size: 13px;
            color: #555;
            background-color: white;
            cursor: pointer;
        }
        
        .category-tag.active {
            background-color: #c62917;
            color: white;
            border-color: #c62917;
        }
        
        /* 알림 리스트 */
        .alert-list {
            list-style: none;
        }
        
        .alert-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            display: flex;
            cursor: pointer;
        }
        
        .alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 12px;
            font-size: 20px;
        }
        
        .alert-info {
            flex: 1;
        }
        
        .alert-title {
            font-size: 15px;
            margin-bottom: 4px;
        }
        
        .alert-message {
            font-size: 13px;
            color: #666;
            margin-bottom: 4px;
        }
        
        .alert-time {
            font-size: 12px;
            color: #888;
        }
        
        .alert-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            background-color: #c62917;
            color: white;
            font-size: 12px;
            margin-left: 4px;
        }

        /* 내 정보 탭 */
        .profile-section {
            padding: 24px 16px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #eee;
        }
        
        .profile-image {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background-color: #f0f0f0;
            margin-right: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            overflow: hidden;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .profile-detail {
            font-size: 14px;
            color: #666;
        }
        
        .menu-list {
            list-style: none;
        }
        
        .menu-item {
            padding: 16px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .menu-title {
            font-size: 15px;
        }
        
        .menu-arrow {
            color: #ccc;
        }

        /* 공지사항 상세 */
        .notice-detail {
            padding: 20px 16px;
        }
        
        .notice-detail-header {
            margin-bottom: 16px;
        }
        
        .notice-detail-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .notice-detail-info {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: #888;
        }
        
        .notice-detail-content {
            font-size: 15px;
            line-height: 1.6;
        }
        
        /* 로딩 인디케이터 */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #888;
        }

        /* 헤더 프로필 이미지 스타일 */
        .header-profile-image {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            margin-left: 8px;
        }
        
        /* 프로필 이미지 스타일 */
        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        /* 회원 탈퇴 버튼 스타일 */
        .delete-account {
            color: #e53935;
        }

        /* 페이지네이션 스타일 */
        .pagination-controls {
            display: flex;
            justify-content: center;
            padding: 16px 0;
            gap: 10px;
        }
        
        .pagination-button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            font-size: 14px;
            cursor: pointer;
        }
        
        .pagination-button:hover {
            background-color: #f0f0f0;
        }
        
        .pagination-button.active {
            background-color: #c62917;
            border-color: #c62917;
            color: white;
        }
        
        .pagination-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* 검색 결과 스타일 개선 */
        .search-results {
            background-color: white;
            border: 1px solid #eee;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 0 16px;
            max-height: 60vh;
            overflow-y: auto;
            position: absolute;
            width: calc(100% - 32px);
            z-index: 200;
        }
        
        .search-results .building-item {
            border-bottom: 1px solid #eee;
        }
        
        .search-results .building-item:last-child {
            border-bottom: none;
        }
        
        .no-results {
            padding: 16px;
            text-align: center;
            color: #888;
            font-size: 14px;
            background-color: white;
            border: 1px solid #eee;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 0 16px;
            position: absolute;
            z-index: 100;
            width: calc(100% - 32px);
        }
        
        .search-highlight {
            background-color: rgba(198, 41, 23, 0.1);
            font-weight: bold;
            color: #c62917;
        }
        
        /* 검색바 컨테이너 스타일 */
        .search-container {
            position: relative;
            width: 100%;
            display: flex;
        }
        
        .search-input {
            flex: 1;
            padding: 8px 30px 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #c62917;
            box-shadow: 0 0 0 2px rgba(198, 41, 23, 0.2);
        }
        
        .search-clear {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            display: none;
            transition: color 0.2s ease;
        }
        
        .search-clear:hover {
            color: #c62917;
        }
        
        /* 검색 결과 항목 호버 효과 */
        .search-results .building-item:hover {
            background-color: #f9f9f9;
        }
        
        /* 빠른 검색 버튼 스타일 */
        .quick-search-buttons {
            background-color: white;
            border-bottom: 1px solid #eee;
            margin-bottom: 12px;
        }
        
        .quick-search-buttons .category-tag {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 16px;
            color: #555;
            cursor: pointer;
            font-size: 13px;
            padding: 6px 12px;
            transition: all 0.2s ease;
        }
        
        .quick-search-buttons .category-tag:hover {
            background-color: #e5e5e5;
        }
        
        .quick-search-buttons .category-tag.active {
            background-color: #c62917;
            border-color: #c62917;
            color: white;
        }
        /* GPS 버튼 스타일 */
        .gps-button {
            position: absolute;
            bottom: 80px;
            right: 10px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            z-index: 100;
            cursor: pointer;
        }

        /* 사용자 위치 마커 스타일 */
        .user-location-marker {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #4285F4;
            border: 3px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        /* 경로 안내 로딩 인디케이터 */
        .route-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        
        .route-loading-text {
            font-size: 14px;
            color: #333;
            margin-left: 8px;
        }
        
        /* 경로 정보 박스 */
        .route-info-box {
            position: absolute;
            bottom: 120px;
            left: 10px;
            right: 10px;
            background-color: white;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 90;
            display: none;
        }
        
        .route-info-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .route-info-detail {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #555;
        }
        
        .route-info-close {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 16px;
            color: #888;
            cursor: pointer;
        }

        /* 홈 화면을 위한 새로운 스타일 추가 */
        /* 사용자 환영 카드 */
        .welcome-card {
            background: linear-gradient(135deg, #c62917, #e64a19);
            color: white;
            border-radius: 12px;
            padding: 16px;
            margin: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .welcome-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .welcome-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* 날씨 위젯 */
        .weather-widget {
            background-color: #f5f9ff;
            border-radius: 12px;
            padding: 16px;
            margin: 0 16px 16px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .weather-info {
            flex: 1;
        }
        
        .weather-temp {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .weather-desc {
            font-size: 13px;
            color: #555;
        }
        
        .weather-icon {
           font-size: 40px;
           margin-left: 16px;
       }
       
       /* 학식 메뉴 카드 */
       .cafeteria-card {
           background-color: white;
           border-radius: 12px;
           border: 1px solid #eee;
           padding: 16px;
           margin: 0 16px 16px 16px;
           box-shadow: 0 2px 6px rgba(0,0,0,0.05);
       }
       
       .cafeteria-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 12px;
       }
       
       .cafeteria-title {
           font-size: 16px;
           font-weight: bold;
       }
       
       .cafeteria-time {
           font-size: 12px;
           color: #888;
           padding: 4px 8px;
           background-color: #f5f5f5;
           border-radius: 12px;
       }
       
       .menu-item-row {
           display: flex;
           justify-content: space-between;
           padding: 8px 0;
           border-bottom: 1px solid #f0f0f0;
       }
       
       .menu-item-row:last-child {
           border-bottom: none;
       }
       
       .menu-name {
           font-size: 14px;
       }
       
       .menu-price {
           font-size: 14px;
           color: #666;
       }
       
       /* 시간표 미리보기 */
       .timetable-preview {
           background-color: white;
           border-radius: 12px;
           border: 1px solid #eee;
           padding: 16px;
           margin: 0 16px 16px 16px;
           box-shadow: 0 2px 6px rgba(0,0,0,0.05);
       }
       
       .timetable-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 12px;
       }
       
       .timetable-date {
           font-size: 14px;
           font-weight: bold;
       }
       
       .timetable-now {
           font-size: 12px;
           padding: 4px 8px;
           background-color: #c62917;
           color: white;
           border-radius: 12px;
       }
       
       .class-item {
           display: flex;
           padding: 10px 0;
           border-bottom: 1px solid #f0f0f0;
       }
       
       .class-item:last-child {
           border-bottom: none;
       }
       
       .class-time {
           width: 60px;
           font-size: 14px;
           color: #666;
           text-align: center;
           padding-right: 10px;
       }
       
       .class-info {
           flex: 1;
       }
       
       .class-name {
           font-size: 15px;
           font-weight: bold;
           margin-bottom: 4px;
       }
       
       .class-location {
           font-size: 13px;
           color: #666;
       }
       
       /* 셔틀버스 정보 카드 */
       .shuttle-card {
           background-color: white;
           border-radius: 12px;
           border: 1px solid #eee;
           padding: 16px;
           margin: 0 16px 16px 16px;
           box-shadow: 0 2px 6px rgba(0,0,0,0.05);
       }
       
       .shuttle-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 12px;
       }
       
       .shuttle-title {
           font-size: 16px;
           font-weight: bold;
       }
       
       .shuttle-icon {
           font-size: 20px;
       }
       
       .shuttle-next {
           background-color: #f9f9f9;
           border-radius: 8px;
           padding: 12px;
           margin-bottom: 12px;
       }
       
       .shuttle-time {
           font-size: 18px;
           font-weight: bold;
           margin-bottom: 4px;
       }
       
       .shuttle-desc {
           font-size: 13px;
           color: #666;
       }
       
       .shuttle-more-times {
           display: flex;
           justify-content: space-between;
       }
       
       .shuttle-time-item {
           text-align: center;
           background-color: #f9f9f9;
           border-radius: 8px;
           padding: 8px 12px;
           flex: 1;
           margin-right: 8px;
       }
       
       .shuttle-time-item:last-child {
           margin-right: 0;
       }
       
       .time-label {
           font-size: 12px;
           color: #888;
           margin-bottom: 4px;
       }
       
       .time-value {
           font-size: 14px;
           font-weight: bold;
       }
       
       /* 캘린더 이벤트 카드 */
       .calendar-card {
           background-color: white;
           border-radius: 12px;
           border: 1px solid #eee;
           padding: 16px;
           margin: 0 16px 16px 16px;
           box-shadow: 0 2px 6px rgba(0,0,0,0.05);
       }
       
       .calendar-list {
           list-style: none;
       }
       
       .calendar-item {
           display: flex;
           padding: 10px 0;
           border-bottom: 1px solid #f0f0f0;
       }
       
       .calendar-item:last-child {
           border-bottom: none;
       }
       
       .calendar-date {
           width: 50px;
           text-align: center;
           margin-right: 12px;
       }
       
       .calendar-day {
           font-size: 16px;
           font-weight: bold;
           color: #c62917;
       }
       
       .calendar-month {
           font-size: 12px;
           color: #888;
       }
       
       .calendar-info {
           flex: 1;
       }
       
       .calendar-title {
           font-size: 15px;
           font-weight: bold;
           margin-bottom: 2px;
       }
       
       .calendar-desc {
           font-size: 13px;
           color: #666;
       }
       
       /* 도서관 상태 카드 */
       .library-card {
           background-color: white;
           border-radius: 12px;
           border: 1px solid #eee;
           padding: 16px;
           margin: 0 16px 16px 16px;
           box-shadow: 0 2px 6px rgba(0,0,0,0.05);
       }
       
       .library-status {
           display: flex;
           justify-content: space-between;
           margin-top: 10px;
       }
       
       .status-item {
           flex: 1;
           text-align: center;
       }
       
       .status-label {
           font-size: 12px;
           color: #888;
           margin-bottom: 4px;
       }
       
       .status-value {
           font-size: 16px;
           font-weight: bold;
       }
       
       .status-bar {
           height: 4px;
           background-color: #f0f0f0;
           border-radius: 2px;
           margin-top: 6px;
           position: relative;
           overflow: hidden;
       }
       
       .status-fill {
           height: 100%;
           background-color: #c62917;
           position: absolute;
           left: 0;
           top: 0;
       }
   </style>
</head>
<body>
   <div class="container">
       <header>
           <div class="logo" onclick="goToHome()">연성대학교</div>
           <div class="header-icons">
               <!-- 로그인 버튼만 남기고 검색 및 알림 아이콘 제거 -->
               <a href="#" class="login-button" onclick="goToPage('login')">로그인</a>
               <div class="profile-dropdown-container" style="display: none;">
                   <div class="header-profile-image" onclick="toggleProfileDropdown()">
                       <!-- 여기에 프로필 이미지가 들어갑니다 -->
                       <img id="headerProfileImg" src="" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;" alt="프로필">
                   </div>
                   <div class="profile-dropdown">
                       <div class="dropdown-profile-info">
                           <div class="dropdown-profile-name">사용자</div>
                           <div class="dropdown-profile-detail">학과 | 학년</div>
                           <div class="dropdown-profile-detail">학번: 0000000000</div>
                       </div>
                       <div class="dropdown-divider"></div>
                       <div class="dropdown-item" onclick="goToPage('profile-edit')">
                           <span class="dropdown-icon">✏️</span>
                           <span>프로필 수정</span>
                       </div>
                       <div class="dropdown-item" onclick="logout()">
                           <div class="dropdown-item" onclick="logout()">
                               <span class="dropdown-icon">🚪</span>
                               <span>로그아웃</span>
                           </div>
                       </div>
                   </div>
               </div>
           </header>
               
           <!-- 홈 탭 -->
           <div id="home-tab" class="tab-content active">
               <!-- 긴급 알림 배너 -->
               <div class="notification-banner" onclick="viewNotification('emergency')">
                   <span class="urgent-icon">📢</span>
                   <span class="notification-text">긴급 공지: 내일(4/9) 대학 전체 휴강 안내 - 시설 점검으로 인한 단수</span>
               </div>
               
               <!-- 환영 카드 -->
               <div class="welcome-card">
                   <div class="welcome-title">안녕하세요, 학우님!</div>
                   <div class="welcome-subtitle">오늘도 연성대학교와 함께 멋진 하루 되세요.</div>
               </div>
               
               <!-- 검색 바 -->
               <div class="search-bar">
                   <input type="text" class="search-input" placeholder="강의실, 공지사항, 교수님 검색" onkeypress="handleSearchKeyPress(event)">
               </div>
               
               <!-- 오늘의 날씨 -->
               <div class="weather-widget">
                   <div class="weather-info">
                       <div class="weather-temp">23°C</div>
                       <div class="weather-desc">맑음, 안양시</div>
                   </div>
                   <div class="weather-icon">☀️</div>
               </div>
               
               <!-- 바로가기 메뉴 -->
               <div class="shortcut-menu">
                   <div class="shortcut-item" onclick="switchTab('facility')">
                       <div class="shortcut-icon">🏫</div>
                       <div class="shortcut-text">강의실</div>
                   </div>
                   <div class="shortcut-item" onclick="switchTab('community')">
                       <div class="shortcut-icon">📝</div>
                       <div class="shortcut-text">강의평가</div>
                   </div>
                   <div class="shortcut-item" onclick="goToPage('shuttle')">
                       <div class="shortcut-icon">🚌</div>
                       <div class="shortcut-text">셔틀버스</div>
                   </div>
                   <div class="shortcut-item" onclick="goToPage('cafeteria')">
                       <div class="shortcut-icon">🍽️</div>
                       <div class="shortcut-text">학식</div>
                   </div>
                   <div class="shortcut-item" onclick="goToPage('academic-calendar')">
                       <div class="shortcut-icon">📅</div>
                       <div class="shortcut-text">학사일정</div>
                   </div>
                </div>
               
                <!-- 오늘의 시간표 -->
                <div class="timetable-preview">
                    <div class="timetable-header">
                        <div class="timetable-date">2025년 4월 8일 (월) 시간표</div>
                        <div class="timetable-now">현재 강의</div>
                    </div>
                    <div id="timetable-preview-content">
                        <!-- 동적으로 생성될 수업 내용 -->
                    </div>
                </div>
               
                <!-- 다음 셔틀버스 -->
                <div class="shuttle-card">
                   <div class="shuttle-header">
                       <div class="shuttle-title">다음 셔틀버스</div>
                       <div class="shuttle-icon">🚌</div>
                   </div>
                   <div class="shuttle-next">
                       <div class="shuttle-time">15분 후 출발</div>
                       <div class="shuttle-desc">학교 → 안양역 (14:30)</div>
                   </div>
                   <div class="shuttle-more-times">
                       <div class="shuttle-time-item">
                           <div class="time-label">다음 #1</div>
                           <div class="time-value">15:00</div>
                       </div>
                       <div class="shuttle-time-item">
                           <div class="time-label">다음 #2</div>
                           <div class="time-value">15:30</div>
                       </div>
                       <div class="shuttle-time-item">
                           <div class="time-label">다음 #3</div>
                           <div class="time-value">16:00</div>
                       </div>
                   </div>
               </div>
               
               <!-- 학식 메뉴 -->
               <div class="cafeteria-card">
                   <div class="cafeteria-header">
                       <div class="cafeteria-title">오늘의 학식</div>
                       <div class="cafeteria-time">11:30 - 14:00</div>
                   </div>
                   <div class="menu-item-row">
                       <div class="menu-name">제육볶음 정식</div>
                       <div class="menu-price">5,500원</div>
                   </div>
                   <div class="menu-item-row">
                       <div class="menu-name">치킨 마요 덮밥</div>
                       <div class="menu-price">5,000원</div>
                   </div>
                   <div class="menu-item-row">
                       <div class="menu-name">냉모밀 세트</div>
                       <div class="menu-price">4,800원</div>
                   </div>
               </div>
               
               <!-- 도서관 현황 -->
               <div class="library-card">
                   <div class="section-title">
                       <span>도서관 현황</span>
                       <a href="#" class="see-all" onclick="goToPage('library')">상세보기</a>
                   </div>
                   <div class="library-status">
                       <div class="status-item">
                           <div class="status-label">일반 열람실</div>
                           <div class="status-value">68%</div>
                           <div class="status-bar">
                               <div class="status-fill" style="width: 68%;"></div>
                           </div>
                       </div>
                       <div class="status-item">
                           <div class="status-label">노트북 열람실</div>
                           <div class="status-value">45%</div>
                           <div class="status-bar">
                               <div class="status-fill" style="width: 45%;"></div>
                           </div>
                       </div>
                   </div>
               </div>
               
               <!-- 학사 일정 -->
               <div class="calendar-card">
                   <div class="section-title">
                       <span>다가오는 학사일정</span>
                       <a href="#" class="see-all" onclick="goToPage('academic-calendar')">전체보기</a>
                   </div>
                   <ul class="calendar-list">
                       <li class="calendar-item">
                           <div class="calendar-date">
                               <div class="calendar-day">22</div>
                               <div class="calendar-month">4월</div>
                           </div>
                           <div class="calendar-info">
                               <div class="calendar-title">2025-1학기 중간고사 시작</div>
                               <div class="calendar-desc">4월 22일(월) ~ 4월 26일(금)</div>
                           </div>
                       </li>
                       <li class="calendar-item">
                           <div class="calendar-date">
                               <div class="calendar-day">11</div>
                               <div class="calendar-month">4월</div>
                           </div>
                           <div class="calendar-info">
                               <div class="calendar-title">국가장학금 2차 신청 마감</div>
                               <div class="calendar-desc">온라인 신청</div>
                           </div>
                       </li>
                       <li class="calendar-item">
                           <div class="calendar-date">
                               <div class="calendar-day">15</div>
                               <div class="calendar-month">4월</div>
                           </div>
                           <div class="calendar-info">
                               <div class="calendar-title">삼성전자 채용설명회</div>
                               <div class="calendar-desc">대강당, 오후 2시</div>
                           </div>
                       </li>
                   </ul>
               </div>
               
               <!-- 공지사항 섹션 -->
               <div class="content-section">
                   <div class="section-title">
                       <span>주요 공지사항</span>
                       <a href="#" class="see-all" onclick="goToPage('notices')">전체보기</a>
                   </div>
                   
                   <div class="category-filter">
                       <div class="category-tag active" onclick="filterNotices('all')">전체</div>
                       <div class="category-tag" onclick="filterNotices('academic')">학사</div>
                       <div class="category-tag" onclick="filterNotices('scholarship')">장학</div>
                       <div class="category-tag" onclick="filterNotices('job')">취업</div>
                       <div class="category-tag" onclick="filterNotices('event')">행사</div>
                       <div class="category-tag" onclick="filterNotices('department')">학과</div>
                   </div>
                   
                   <ul class="notice-list">
                       <!-- 알림창 없이 공지사항 상세 페이지로 바로 이동하도록 수정 -->
                       <li class="notice-item" onclick="goToNoticeDetail('notice1')">
                           <div class="notice-header">
                               <span class="notice-category">학사</span>
                               <span class="notice-date">2025.04.08</span>
                           </div>
                           <div class="notice-title">2025학년도 1학기 중간고사 일정 안내</div>
                           <div class="notice-summary">
                               4월 22일(월)부터 4월 26일(금)까지 중간고사가 진행됩니다. 자세한 시간표는 학과 사무실에서 확인하세요.
                           </div>
                       </li>
                       <li class="notice-item" onclick="goToNoticeDetail('notice2')">
                           <div class="notice-header">
                               <span class="notice-category">장학</span>
                               <span class="notice-date">2025.04.07</span>
                           </div>
                           <div class="notice-title">국가장학금 2차 신청 마감 안내</div>
                           <div class="notice-summary">
                               국가장학금 2차 신청이 이번 주 금요일(4/11)에 마감됩니다. 아직 신청하지 않은 학생들은 서둘러 신청해주세요.
                           </div>
                       </li>
                       <li class="notice-item" onclick="goToNoticeDetail('notice3')">
                           <div class="notice-header">
                               <span class="notice-category">취업</span>
                               <span class="notice-date">2025.04.06</span>
                           </div>
                           <div class="notice-title">삼성전자 대규모 채용설명회 개최 안내</div>
                           <div class="notice-summary">
                               4월 15일(화) 오후 2시 대강당에서 삼성전자 채용설명회가 진행됩니다. 참석을 원하는 학생은 사전 신청 바랍니다.
                           </div>
                       </li>
                   </ul>
               </div>
               
               <!-- 강의평가 섹션 -->
               <div class="content-section">
                   <div class="section-title">
                       <span>인기 강의평가</span>
                       <a href="#" class="see-all" onclick="switchTab('community')">전체보기</a>
                   </div>
                   
                   <ul class="lecture-list">
                       <li class="lecture-item" onclick="viewLectureDetail('web-programming')">
                           <div class="lecture-header">
                               <div class="lecture-title">웹 프로그래밍 실습</div>
                               <div class="lecture-rating">4.8</div>
                           </div>
                           <div class="lecture-info">
                               <span class="lecture-professor">김민수 교수님</span>
                               <span>컴퓨터정보학과</span>
                           </div>
                           <div class="rating-stars">★★★★★</div>
                           <div class="lecture-reviews">
                               "과제는 많지만 실력이 확실히 늘어요! 취업에 큰 도움이 됩니다."
                           </div>
                       </li>
                       <li class="lecture-item" onclick="viewLectureDetail('marketing')">
                           <div class="lecture-header">
                               <div class="lecture-title">마케팅 원론</div>
                               <div class="lecture-rating">4.5</div>
                           </div>
                           <div class="lecture-info">
                               <span class="lecture-professor">이지영 교수님</span>
                               <span>경영학과</span>
                           </div>
                           <div class="rating-stars">★★★★☆</div>
                           <div class="lecture-reviews">
                               "실제 사례를 많이 다루어서 이해하기 쉽고 재미있어요."
                           </div>
                       </li>
                   </ul>
               </div>
               
               <div class="content-pad"></div>
           </div>

           
            
            <!-- 시설 탭 -->
            <div id="facility-tab" class="tab-content">
                <!-- 검색 바 - 새로운 구조로 변경 -->
                <div class="search-bar">
                    <div class="search-container">
                        <input type="text" id="facility-search-input" class="search-input" placeholder="건물, 강의실, 편의시설 검색" oninput="searchFacilities(this.value)">
                        <button class="search-clear" onclick="clearSearch()">✕</button>
                    </div>
                </div>
                
                <!-- 빠른 검색 버튼 영역 -->
                <div class="quick-search-buttons">
                    <div class="section-title" style="margin-top: 12px; margin-left: 16px; margin-right: 16px;">
                        <span>빠른 검색</span>
                    </div>
                    <div style="display: flex; overflow-x: auto; padding: 0 16px 12px 16px; gap: 8px;">
                        <button class="category-tag" onclick="quickSearch('강의실')">강의실</button>
                        <button class="category-tag" onclick="quickSearch('학생')">학생시설</button>
                        <button class="category-tag" onclick="quickSearch('식당')">식당/카페</button>
                        <button class="category-tag" onclick="quickSearch('도서관')">도서관</button>
                        <button class="category-tag" onclick="quickSearch('공학')">공학계열</button>
                    </div>
                </div>
                
                <!-- 검색 결과를 표시할 컨테이너 추가 -->
                <div id="search-results" class="search-results" style="display: none;">
                    <!-- 검색 결과가 여기에 동적으로 추가됩니다 -->
                </div>
                
                <!-- 검색 결과가 없을 때 표시될 내용 -->
                <div id="no-results" class="no-results" style="display: none;">
                    검색 결과가 없습니다.
                </div>
                
                <!-- 원래 내용은 검색 결과가 없을 때만 표시 -->
                <div id="original-content">
                    <!-- 네이버 지도로 대체된 캠퍼스 맵 -->
                    <div class="campus-map" id="naverMap">
                        <!-- 지도가 로드되기 전에 표시할 이미지 삭제 -->
                        <!-- <img src="/api/placeholder/400/250" alt="연성대학교 캠퍼스 지도"> -->
                        <div class="map-control-buttons">
                            <div class="map-button" onclick="zoomIn()">🔍+</div>
                            <div class="map-button" onclick="zoomOut()">🔍-</div>
                            <div class="map-button" onclick="resetMapView()">🏠</div>
                        </div>
    
                        <!-- 여기에 GPS 버튼 추가 -->
                        <div class="gps-button" onclick="trackUserLocation()">📍</div>
                        
                        <!-- 경로 정보 로딩 인디케이터 -->
                        <div class="route-loading" id="routeLoading">
                            <span>🔄</span>
                            <span class="route-loading-text">경로를 계산하는 중...</span>
                        </div>
                        
                        <!-- 경로 정보 박스 -->
                        <div class="route-info-box" id="routeInfoBox">
                            <span class="route-info-close" onclick="closeRouteInfo()">✕</span>
                            <div class="route-info-title">목적지: <span id="routeDestination"></span></div>
                            <div class="route-info-detail">
                                <div>거리: <span id="routeDistance"></span></div>
                                <div>예상 소요시간: <span id="routeDuration"></span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-title">
                            <span>주요 건물</span>
                        </div>
                        
                        <ul class="building-list">
                            <!-- 건물 항목들이 JavaScript로 동적 생성됩니다 -->
                        </ul>
                        
                        <!-- 페이지네이션 컨트롤 추가 -->
                        <div id="pagination-controls" class="pagination-controls">
                            <!-- 페이지 버튼들이 JavaScript로 동적 생성됩니다 -->
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-title">
                            <span>편의시설</span>
                        </div>
                        
                        <div class="facility-list">
                            <div class="facility-item" onclick="showFacilityDetail('cafeteria')">
                                <div class="facility-image">
                                    <img src="https://placehold.co/150x100/gray/white?text=학생식당" alt="학생식당">
                                </div>
                                <div class="facility-info">
                                    <div class="facility-name">학생식당</div>
                                    <div class="facility-location">학생복지센터 2층</div>
                                </div>
                            </div>
                            <div class="facility-item" onclick="showFacilityDetail('cafe')">
                                <div class="facility-image">
                                    <img src="https://placehold.co/150x100/gray/white?text=카페" alt="카페">
                                </div>
                                <div class="facility-info">
                                    <div class="facility-name">카페 연성</div>
                                    <div class="facility-location">문화1관 1층</div>
                                </div>
                            </div>
                            <div class="facility-item" onclick="showFacilityDetail('convenience')">
                                <div class="facility-image">
                                    <img src="https://placehold.co/150x100/gray/white?text=편의점" alt="편의점">
                                </div>
                                <div class="facility-info">
                                    <div class="facility-name">CU 편의점</div>
                                    <div class="facility-location">학생복지센터 1층</div>
                                </div>
                            </div>
                            <div class="facility-item" onclick="showFacilityDetail('atm')">
                                <div class="facility-image">
                                    <img src="https://placehold.co/150x100/gray/white?text=ATM" alt="ATM">
                                </div>
                                <div class="facility-info">
                                    <div class="facility-name">ATM</div>
                                    <div class="facility-location">학생복지센터 1층</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="content-pad"></div>
            </div>
            
            <!-- 커뮤니티 탭 -->
            <div id="community-tab" class="tab-content">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="강의평가 검색" onkeypress="handleSearchKeyPress(event)">
                </div>
                
                <div class="content-section">
                    <div class="section-title">
                        <span>강의평가</span>
                    </div>
                    
                    <div class="category-filter">
                        <div class="category-tag active" onclick="filterLectures('all')">전체</div>
                        <div class="category-tag" onclick="filterLectures('general')">교양</div>
                        <div class="category-tag" onclick="filterLectures('required')">전공필수</div>
                        <div class="category-tag" onclick="filterLectures('optional')">전공선택</div>
                    </div>
                    <ul class="lecture-list">
                        <li class="lecture-item" onclick="viewLectureDetail('web-programming')">
                            <div class="lecture-header">
                                <div class="lecture-title">웹 프로그래밍 실습</div>
                                <div class="lecture-rating">4.8</div>
                            </div>
                            <div class="lecture-info">
                                <span class="lecture-professor">김민수 교수님</span>
                                <span>컴퓨터정보학과</span>
                            </div>
                            <div class="rating-stars">★★★★★</div>
                            <div class="lecture-reviews">
                                "과제는 많지만 실력이 확실히 늘어요! 취업에 큰 도움이 됩니다."
                            </div>
                        </li>
                        <li class="lecture-item" onclick="viewLectureDetail('english')">
                            <div class="lecture-header">
                                <div class="lecture-title">영어회화</div>
                                <div class="lecture-rating">4.3</div>
                            </div>
                            <div class="lecture-info">
                                <span class="lecture-professor">John Smith 교수님</span>
                                <span>교양과정</span>
                            </div>
                            <div class="rating-stars">★★★★☆</div>
                            <div class="lecture-reviews">
                                "원어민 교수님과 실제 대화를 많이 할 수 있어서 좋아요."
                            </div>
                        </li>
                        <li class="lecture-item" onclick="viewLectureDetail('statistics')">
                            <div class="lecture-header">
                                <div class="lecture-title">경영통계학</div>
                                <div class="lecture-rating">3.7</div>
                            </div>
                            <div class="lecture-info">
                                <span class="lecture-professor">박성호 교수님</span>
                                <span>경영학과</span>
                            </div>
                            <div class="rating-stars">★★★☆☆</div>
                            <div class="lecture-reviews">
                                "내용이 어렵지만 설명을 잘 해주세요. 시험은 까다로운 편."
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div class="content-pad"></div>
            </div>
            
            <!-- 내 정보 탭 -->
            <div id="profile-tab" class="tab-content">
                <div class="profile-section">
                    <div class="profile-image">👨‍🎓</div>
                    <div class="profile-info">
                        <div class="profile-name">조희정</div>
                        <div class="profile-detail">경영학과 | 3학년</div>
                        <div class="profile-detail">학번: 2021100215</div>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-title">
                        <span>내 정보 관리</span>
                    </div>
                    
                    <ul class="menu-list">
                        <li class="menu-item" onclick="navigateToProfilePage('timetable')">
                            <div class="menu-title">내 시간표</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('my-courses')">
                            <div class="menu-title">내 수강 강의</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('favorite-classrooms')">
                            <div class="menu-title">즐겨찾는 강의실</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('profile-edit')">
                            <div class="menu-title">개인정보 수정</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <!-- 회원 탈퇴 메뉴 추가 -->
                        <li class="menu-item" onclick="deleteAccount()">
                            <div class="menu-title delete-account">회원 탈퇴</div>
                            <div class="menu-arrow">›</div>
                        </li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <div class="section-title">
                        <span>학적 정보</span>
                    </div>
                    
                    <ul class="menu-list">
                        <li class="menu-item" onclick="navigateToProfilePage('grades')">
                            <div class="menu-title">성적 조회</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('course-registration')">
                            <div class="menu-title">수강 신청 내역</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('scholarships')">
                            <div class="menu-title">장학금 내역</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('tuition')">
                            <div class="menu-title">등록금 납부 내역</div>
                            <div class="menu-arrow">›</div>
                        </li>
                    </ul>
                </div>
                
                <div class="content-section">
                    <div class="section-title">
                        <span>앱 설정</span>
                    </div>
                    
                    <ul class="menu-list">
                        <li class="menu-item" onclick="navigateToProfilePage('notification-settings')">
                            <div class="menu-title">알림 설정</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('widget-settings')">
                            <div class="menu-title">위젯 및 메뉴 설정</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="resetAllSettings()">
                            <div class="menu-title">모든 설정 초기화</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="navigateToProfilePage('app-info')">
                            <div class="menu-title">앱 정보</div>
                            <div class="menu-arrow">›</div>
                        </li>
                        <li class="menu-item" onclick="logout()">
                            <div class="menu-title">로그아웃</div>
                            <div class="menu-arrow">›</div>
                        </li>
                    </ul>
                </div>
                
                <div class="content-pad"></div>
            </div>
            
            <!-- 알림 탭 -->
            <div id="alert-tab" class="tab-content">
                <div class="content-section">
                    <div class="section-title">
                        <span>알림</span>
                    </div>
                    
                    <ul class="alert-list">
                        <li class="alert-item" onclick="viewNotification('emergency')">
                            <div class="alert-icon">📢</div>
                            <div class="alert-info">
                                <div class="alert-title">긴급 공지 <span class="alert-badge">중요</span></div>
                                <div class="alert-message">내일(4/9) 대학 전체 휴강 안내 - 시설 점검으로 인한 단수</div>
                                <div class="alert-time">10분 전</div>
                            </div>
                        </li>
                        <li class="alert-item" onclick="viewNotification('classroom')">
                            <div class="alert-icon">🏫</div>
                            <div class="alert-info">
                                <div class="alert-title">강의실 알림</div>
                                <div class="alert-message">웹 프로그래밍 실습 강의실이 3-101호에서 3-201호로 변경되었습니다.</div>
                                <div class="alert-time">30분 전</div>
                            </div>
                        </li>
                        <li class="alert-item" onclick="viewNotification('assignment')">
                            <div class="alert-icon">📝</div>
                            <div class="alert-info">
                                <div class="alert-title">과제 알림</div>
                                <div class="alert-message">마케팅 원론 과제 제출 기한이 내일 오후 6시까지입니다.</div>
                                <div class="alert-time">1시간 전</div>
                            </div>
                        </li>
                        <li class="alert-item" onclick="viewNotification('library')">
                            <div class="alert-icon">📚</div>
                            <div class="alert-info">
                                <div class="alert-title">도서관 알림</div>
                                <div class="alert-message">대출하신 책 "디자인 씽킹의 이해"의 반납 기한이 이틀 남았습니다.</div>
                                <div class="alert-time">3시간 전</div>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div class="content-pad"></div>
            </div>
            
            <!-- 하단 탭 메뉴 -->
            <div class="tab-menu">
                <div class="tab-item active" onclick="switchTab('home')">
                    <span class="tab-icon">🏠</span>
                    <span>홈</span>
                </div>
                <div class="tab-item" onclick="switchTab('facility')">
                    <span class="tab-icon">🏫</span>
                    <span>시설</span>
                </div>
                <div class="tab-item" onclick="switchTab('community')">
                    <span class="tab-icon">💬</span>
                    <span>커뮤니티</span>
                </div>
                <div class="tab-item" onclick="switchTab('profile')">
                    <span class="tab-icon">👤</span>
                    <span>내 정보</span>
                </div>
                <div class="tab-item" onclick="switchTab('alert')">
                    <span class="tab-icon">🔔</span>
                    <span>알림</span>
                </div>
            </div>
        </div>
        
        <script>
            // 건물 데이터 (배열로 정의) - 이미지에서 확인된 건물 이름으로 수정
            const buildingData = [
            {
                id: '공학1관',
                name: '공학1관',
                description: '공학계열 강의실, 실험실',
                image: 'https://placehold.co/80x60/gray/white?text=공학1관',
                type: 'building',
                position: { lat: 37.39632767479923, lng: 126.90699348692698 }
            },
            {
                id: '자연과학관',
                name: '자연과학관',
                description: '반려동물보건학, 반려동물산업학',
                image: 'https://placehold.co/80x60/gray/white?text=자연과학관',
                type: 'building',
                position: { lat:  37.39669466288283, lng: 126.90676716508685 }
            },
            {
                id: '식품과학관',
                name: '식품과학관',
                description: '식품영양학과, 조리실습실',
                image: 'https://placehold.co/80x60/gray/white?text=식품과학관',
                type: 'building',
                position: { lat: 37.39714809720343, lng: 126.90762208499473 }
            },
            {
                id: '도의관',
                name: '도의관',
                description: '교양 수업, 강당',
                image: 'https://placehold.co/80x60/gray/white?text=도의관',
                type: 'building',
                position: { lat: 37.39679932128769, lng: 126.90809683728425 }
            },
            {
                id: '공학2관',
                name: '공학2관',
                description: '공학계열 실습실, 연구실',
                image: 'https://placehold.co/80x60/gray/white?text=공학2관',
                type: 'building',
                position: { lat: 37.396789747114205, lng: 126.90737406929797 }
            },
            {
                id: '문화1관',
                name: '문화1관',
                description: '인문사회계열 강의실',
                image: 'https://placehold.co/80x60/gray/white?text=문화1관',
                type: 'building',
                position: { lat:  37.39576992475254, lng: 126.90812350405056 }
            },
            {
                id: '연곡문화센터',
                name: '연곡문화센터',
                description: '기숙사, 컨벤션홀, 평생교육원',
                image: 'https://placehold.co/80x60/gray/white?text=연곡문화센터',
                type: 'building',
                position: { lat: 37.398046192024914, lng: 126.90966512810492 }
            },
            {
                id: '창조관',
                name: '창조관',
                description: '학과 사무실, 강의실',
                image: 'https://placehold.co/80x60/gray/white?text=창조관',
                type: 'building',
            position: { lat: 37.39730791148064, lng: 126.91039726900274 }
        },
        {
            id: '운동장',
            name: '운동장',
            description: '체육활동, 행사장',
            image: 'https://placehold.co/80x60/gray/white?text=운동장',
            type: 'building',
            position: { lat: 37.39673944839101, lng: 126.90932224700094 }
        },
        {
            id: '농구장',
            name: '농구장',
            description: '체육활동',
            image: 'https://placehold.co/80x60/gray/white?text=농구장',
            type: 'building',
            position: { lat: 37.39667684947615, lng: 126.90994063692402 }
        },
        {
            id: '학생복지센터',
            name: '학생복지센터',
            description: '학생지원 시설',
            image: 'https://placehold.co/80x60/gray/white?text=학생복지센터',
            type: 'building',
            position: { lat:  37.3962916630711, lng: 126.90994109780426 }
        },
        {
            id: '창의교육센터',
            name: '창의교육센터',
            description: '항공서비스과 항공실습실, 카페',
            image: 'https://placehold.co/80x60/gray/white?text=창의교육센터',
            type: 'building',
            position: { lat:  37.39737971014044, lng: 126.91002449732869 }
        },
        {
            id: '문화2관',
            name: '문화2관',
            description: ' 문화콘텐츠계열 강의실',
            image: 'https://placehold.co/80x60/gray/white?text=문화2관',
            type: 'building',
            position: { lat:  37.396035307891026, lng: 126.90758674745014 }
        },
        {
            id: '대학본관',
            name: '대학본관',
            description: '유통물류학과, 총장실',
            image: 'https://placehold.co/80x60/gray/white?text=대학본관',
            type: 'building',
            position: { lat:  37.397467068076345, lng: 126.90938066144557 }
        },
        {
            id: '학술정보관',
            name: '학술정보관',
            description: '독서실',
            image: 'https://placehold.co/80x60/gray/white?text=학술정보관',
            type: 'building',
            position: { lat:  37.39637467129301, lng: 126.906603807587 }
        }
    ];

    // 편의시설 데이터 정의
    const facilityData = [
        {
            id: 'cafeteria',
            name: '학생식당',
            description: '학생복지센터 2층',
            image: 'https://placehold.co/150x100/gray/white?text=학생식당',
            type: 'facility',
            position: { lat: 37.377100, lng: 126.663600 },
            relatedBuilding: '학생복지센터'
        },
        {
            id: 'cafe',
            name: '카페 연성',
            description: '문화1관 1층',
            image: 'https://placehold.co/150x100/gray/white?text=카페',
            type: 'facility',
            position: { lat: 37.378300, lng: 126.662700 },
            relatedBuilding: '문화1관'
        },
        {
            id: 'convenience',
            name: 'CU 편의점',
            description: '학생복지센터 1층',
            image: 'https://placehold.co/150x100/gray/white?text=편의점',
            type: 'facility',
            position: { lat: 37.377100, lng: 126.663700 },
            relatedBuilding: '학생복지센터'
        },
        {
            id: 'atm',
            name: 'ATM',
            description: '학생복지센터 1층',
            image: 'https://placehold.co/150x100/gray/white?text=ATM',
            type: 'facility',
            position: { lat: 37.377100, lng: 126.663800 },
            relatedBuilding: '학생복지센터'
        },
        
    ];
        
    // 네이버 지도 관련 변수
    let naverMap;
    let mapMarkers = [];
    let infoWindows = [];
    let userMarker = null;
    let userLocationCircle = null;
    let userLocationWatchId = null;
    let userLocation = null;
    let isTrackingUser = false;
    let routePolyline = null; // 경로 폴리라인
        
    // 페이지네이션 변수
    let currentPage = 1;
    const buildingsPerPage = 5;

    // 시간표 미리보기 업데이트
    function updateTimetablePreview() {
        console.log('시간표 미리보기 업데이트 시작');
        
        // 현재 로그인된 사용자 확인
        const currentUser = localStorage.getItem('currentLoggedInUser');
        if (!currentUser) {
            console.log('로그인되지 않은 상태입니다.');
            return;
        }
        
        // 시간표 컨테이너 확인
        const timetablePreview = document.querySelector('.timetable-preview');
        if (!timetablePreview) {
            console.log('시간표 미리보기 요소를 찾을 수 없습니다.');
            return;
        }
        
        // 현재 날짜 및 시간 정보
        const now = new Date();
        const days = ['일', '월', '화', '수', '목', '금', '토'];
        const currentDay = now.getDay(); // 0(일) ~ 6(토)
        const currentTime = now.getHours() * 60 + now.getMinutes(); // 분 단위
        
        // 날짜 업데이트
        const dateEl = timetablePreview.querySelector('.timetable-date');
        if (dateEl) {
            const dateStr = `${now.getFullYear()}년 ${now.getMonth() + 1}월 ${now.getDate()}일 (${days[currentDay]}) 시간표`;
            dateEl.textContent = dateStr;
        }
        
        // 현재 학기 정보 계산
        const currentYear = now.getFullYear();
        const currentMonth = now.getMonth() + 1;
        let semester = 1;
        
        if (currentMonth >= 3 && currentMonth <= 8) {
            semester = 1;
        } else {
            semester = 2;
        }
        
        // 시간표 데이터 가져오기
        const currentTimetable = JSON.parse(localStorage.getItem(`currentTimetable_user_${currentUser}`)) || { id: 1 };
        const coursesKey = `courses_${currentYear}_${semester}_${currentTimetable.id}_user_${currentUser}`;
        const courses = JSON.parse(localStorage.getItem(coursesKey)) || [];
        
        console.log('시간표 데이터:', courses);
        
        // 교시별 시간 정보
        const periodTimes = {
            1: { start: "09:00", end: "10:20" },
            2: { start: "10:30", end: "11:50" },
            3: { start: "12:00", end: "13:20" },
            4: { start: "13:30", end: "14:50" },
            5: { start: "15:00", end: "16:20" },
            6: { start: "16:30", end: "17:50" },
            7: { start: "18:00", end: "19:20" },
            8: { start: "19:30", end: "20:50" },
            9: { start: "21:00", end: "22:20" }
        };
        
        // 시간 문자열을 분으로 변환
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }
        
        // 오늘의 수업 찾기
        let todaysClasses = [];
        let currentClass = null;
        let nextClass = null;
        
        // 일요일이 아닌 경우에만 수업 검색
        if (currentDay !== 0) {
            courses.forEach(course => {
                course.times.forEach(time => {
                    if (time.day === currentDay) {
                        // 수업 시간 정보 생성
                        const startMinutes = timeToMinutes(periodTimes[time.start].start);
                        const endMinutes = timeToMinutes(periodTimes[time.end].end);
                        
                        // 상태 결정
                        let status = '수강 예정';
                        let statusClass = 'status-upcoming';
                        
                        if (currentTime >= startMinutes && currentTime < endMinutes) {
                            status = '수강 중';
                            statusClass = 'status-current';
                            currentClass = course;
                        } else if (currentTime >= endMinutes) {
                            status = '수강 종료';
                            statusClass = 'status-completed';
                        }
                        
                        todaysClasses.push({
                            course: course,
                            startTime: periodTimes[time.start].start,
                            endTime: periodTimes[time.end].end,
                            status: status,
                            statusClass: statusClass,
                            startMinutes: startMinutes,
                            professor: course.professor || '교수명 없음',
                            room: course.room || '강의실 미정'
                        });
                    }
                });
            });
        }
        
        // 시간 순으로 정렬
        todaysClasses.sort((a, b) => a.startMinutes - b.startMinutes);
        
        // 현재 강의 상태 업데이트
        const statusEl = timetablePreview.querySelector('.timetable-now');
        if (statusEl) {
            if (currentClass) {
                statusEl.textContent = '현재 강의';
                statusEl.style.backgroundColor = '#4caf50';
            } else {
                statusEl.textContent = '강의 없음';
                statusEl.style.backgroundColor = '#888';
            }
        }
        
        // 시간표 본문 내용 생성
        const timetableContent = document.querySelector('.timetable-preview');
        const existingClasses = timetableContent.querySelectorAll('.class-item');
        existingClasses.forEach(el => el.remove());
        
        if (todaysClasses.length === 0) {
            // 오늘 강의가 없는 경우
            const noClassEl = document.createElement('div');
            noClassEl.className = 'class-item';
            noClassEl.style.textAlign = 'center';
            noClassEl.style.color = '#888';
            noClassEl.style.fontStyle = 'italic';
            noClassEl.innerHTML = `
                <div class="class-info">
                    <div class="class-name">오늘 강의가 없습니다</div>
                    <div class="class-location">편안한 하루 되세요 😊</div>
                </div>
            `;
            timetableContent.appendChild(noClassEl);
        } else {
            // 오늘의 강의 목록 표시
            todaysClasses.forEach(classInfo => {
                const classEl = document.createElement('div');
                classEl.className = 'class-item';
                
                classEl.innerHTML = `
                    <div class="class-time">${classInfo.startTime}</div>
                    <div class="class-info">
                        <div class="class-name">${classInfo.course.name}</div>
                        <div class="class-location">${classInfo.professor} | ${classInfo.room}</div>
                        <div class="class-status ${classInfo.statusClass}">${classInfo.status}</div>
                    </div>
                `;
                
                timetableContent.appendChild(classEl);
            });
        }
        
        console.log('시간표 미리보기 업데이트 완료');
    }

    // 시간표 미리보기 클릭 시 시간표 페이지로 이동
    function goToTimetable() {
        const currentUser = localStorage.getItem('currentLoggedInUser');
        if (!currentUser) {
            alert('로그인이 필요한 서비스입니다.');
            goToPage('login');
            return;
        }
        
        goToPage('timetable');
    }

    // 시간표 미리보기 업데이트를 정기적으로 실행
    function startTimetableUpdater() {
        // 페이지 로드 시 즉시 업데이트
        updateTimetablePreview();
        
        // 1분마다 업데이트
        setInterval(updateTimetablePreview, 60000);
    }

    // 시간표 미리보기 클릭 이벤트 추가
    document.addEventListener('DOMContentLoaded', function() {
        const timetablePreview = document.querySelector('.timetable-preview');
        if (timetablePreview) {
            timetablePreview.addEventListener('click', goToTimetable);
            timetablePreview.style.cursor = 'pointer';
        }
        
        // 시간표 업데이트 시작
        startTimetableUpdater();
    });

    // 탭 전환 함수
    function switchTab(tabName) {
        // 모든 탭 숨기기
        const tabs = document.querySelectorAll('.tab-content');
        tabs.forEach(tab => tab.classList.remove('active'));
        
        // 모든 탭 메뉴 비활성화
        const tabItems = document.querySelectorAll('.tab-item');
        tabItems.forEach(item => item.classList.remove('active'));
        
        // 선택된 탭 활성화
        document.getElementById(tabName + '-tab').classList.add('active');
        
        // 선택된 탭 메뉴 활성화
        const targetTab = [...tabItems].find(item => item.querySelector('span:last-child').textContent === getTabDisplayName(tabName));
        if (targetTab) {
            targetTab.classList.add('active');
        }
        
        // 시설 탭을 처음 열 때 지도 초기화
        if (tabName === 'facility' && !naverMap) {
            initMap();
        }
    }
    
    // 탭 이름을 디스플레이 이름으로 변환
    function getTabDisplayName(tabName) {
        const names = {
            'home': '홈',
            'facility': '시설',
            'community': '커뮤니티',
            'profile': '내 정보',
            'alert': '알림'
        };
        return names[tabName] || tabName;
    }
    
    // 페이지 로드 시 초기화
    document.addEventListener('DOMContentLoaded', function() {
        console.log('페이지 로드 완료');
        
        // 초기 건물 목록 생성
        renderBuildingList();
        
        // 로그인 상태 확인
        checkLoginStatus();
        
        // 홈 탭이 기본 활성화
        switchTab('home');
    });
    
    // 로그인 상태 확인 및 UI 업데이트
    function checkLoginStatus() {
        const currentUser = localStorage.getItem('currentLoggedInUser');
        const loginButton = document.querySelector('.login-button');
        const profileDropdownContainer = document.querySelector('.profile-dropdown-container');
        
        if (currentUser) {
            // 로그인된 상태
            loginButton.style.display = 'none';
            profileDropdownContainer.style.display = 'block';
            
            // 사용자 정보 업데이트
            updateUserProfile();
        } else {
            // 로그인되지 않은 상태
            loginButton.style.display = 'block';
            profileDropdownContainer.style.display = 'none';
        }
    }
    
    // 사용자 프로필 정보 업데이트
    function updateUserProfile() {
        const currentUser = localStorage.getItem('currentLoggedInUser');
        const userData = JSON.parse(localStorage.getItem(`userData_${currentUser}`));
        
        if (userData) {
            // 헤더 프로필
            document.querySelector('.dropdown-profile-name').textContent = userData.name;
            document.querySelector('.dropdown-profile-detail').textContent = `${userData.department || ''} | ${userData.grade || ''}학년`;
            document.querySelectorAll('.dropdown-profile-detail')[1].textContent = `학번: ${currentUser}`;
            
            // 내 정보 탭 프로필
            document.querySelector('.profile-name').textContent = userData.name;
            document.querySelector('.profile-detail').textContent = `${userData.department || ''} | ${userData.grade || ''}학년`;
            document.querySelectorAll('.profile-detail')[1].textContent = `학번: ${currentUser}`;
            
            // 환영 카드 업데이트
            const welcomeTitle = document.querySelector('.welcome-title');
            if (welcomeTitle) {
                welcomeTitle.textContent = `안녕하세요, ${userData.name}님!`;
            }
            
            // 프로필 이미지가 있다면 설정
            if (userData.profileImage) {
                const headerImg = document.getElementById('headerProfileImg');
                const profileImgs = document.querySelectorAll('.profile-image');
                
                if (headerImg) headerImg.src = userData.profileImage;
                profileImgs.forEach(img => {
                    const imgTag = img.querySelector('img');
                    if (imgTag) {
                        imgTag.src = userData.profileImage;
                    } else {
                        img.innerHTML = `<img src="${userData.profileImage}" alt="프로필">`;
                    }
                });
            }
        }
    }
    
    // 프로필 드롭다운 토글
    function toggleProfileDropdown() {
        const dropdown = document.querySelector('.profile-dropdown');
        dropdown.classList.toggle('active');
    }
    
    // 문서 클릭 시 드롭다운 닫기
    document.addEventListener('click', function(event) {
        const dropdown = document.querySelector('.profile-dropdown');
        const profileContainer = document.querySelector('.profile-dropdown-container');
        
        if (!profileContainer.contains(event.target)) {
            dropdown.classList.remove('active');
        }
    });
    
    // 네이버 지도 초기화
    function initMap() {
        console.log('지도 초기화 시작');
        
        try {
            const mapOptions = {
                center: new naver.maps.LatLng(37.396789, 126.907800), // 연성대학교 좌표
                zoom: 17,
                minZoom: 15,
                maxZoom: 20,
                mapTypeControl: false,
                zoomControl: false,
                scaleControl: false,
                logoControl: false
            };
            
            naverMap = new naver.maps.Map('naverMap', mapOptions);
            console.log('지도 초기화 완료');
            
            // 지도에 마커 추가
            addMapMarkers();
            
        } catch (error) {
            console.error('지도 초기화 중 오류:', error);
            // 지도 로드 실패 시 대체 이미지 표시
            const mapContainer = document.getElementById('naverMap');
            mapContainer.innerHTML = '<img src="https://placehold.co/400x350/gray/white?text=지도를 불러올 수 없습니다" alt="지도 로드 실패">';
        }
    }
    
    // 지도에 마커 추가
    function addMapMarkers() {
        if (!naverMap) return;
        
        buildingData.forEach(building => {
            const marker = new naver.maps.Marker({
                position: new naver.maps.LatLng(building.position.lat, building.position.lng),
                map: naverMap,
                title: building.name,
                icon: {
                    content: '<div style="width: 24px; height: 24px; background: #c62917; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold;">🏫</div>',
                    size: new naver.maps.Size(24, 24),
                    anchor: new naver.maps.Point(12, 12)
                }
            });
            
            const infoWindow = new naver.maps.InfoWindow({
                content: `
                    <div class="map-info-window">
                        <div class="map-info-title">${building.name}</div>
                        <div class="map-info-desc">${building.description}</div>
                    </div>
                `,
                borderWidth: 0,
                borderRadius: 8
            });
            
            naver.maps.Event.addListener(marker, 'click', function() {
                // 다른 정보창 닫기
                infoWindows.forEach(iw => iw.close());
                infoWindow.open(naverMap, marker);
            });
            
            mapMarkers.push(marker);
            infoWindows.push(infoWindow);
        });
    }
    
    // 지도 확대/축소
    function zoomIn() {
        if (naverMap) {
            const currentZoom = naverMap.getZoom();
            naverMap.setZoom(currentZoom + 1);
        }
    }
    
    function zoomOut() {
        if (naverMap) {
            const currentZoom = naverMap.getZoom();
            naverMap.setZoom(Math.max(currentZoom - 1, 15));
        }
    }
    
    // 지도 위치 리셋
    function resetMapView() {
        if (naverMap) {
            naverMap.setCenter(new naver.maps.LatLng(37.396789, 126.907800));
            naverMap.setZoom(17);
        }
    }
    
    // 현재 위치 추적
    function trackUserLocation() {
        console.log('GPS 위치 추적 시작');
        
        if (!navigator.geolocation) {
            alert('GPS를 지원하지 않는 브라우저입니다.');
            return;
        }
        
        if (isTrackingUser) {
            // 추적 중지
            stopLocationTracking();
        } else {
            // 추적 시작
            const options = {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 30000
            };
            
            userLocationWatchId = navigator.geolocation.watchPosition(
                function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    userLocation = { lat, lng };
                    
                    console.log('사용자 위치:', userLocation);
                    
                    if (naverMap) {
                        // 사용자 위치에 마커 표시
                        if (userMarker) {
                            userMarker.setPosition(new naver.maps.LatLng(lat, lng));
                        } else {
                            userMarker = new naver.maps.Marker({
                                position: new naver.maps.LatLng(lat, lng),
                                map: naverMap,
                                title: '현재 위치',
                                icon: {
                                    content: '<div class="user-location-marker"></div>',
                                    size: new naver.maps.Size(20, 20),
                                    anchor: new naver.maps.Point(10, 10)
                                },
                                zIndex: 1000
                            });
                        }
                        
                        // 지도 중심 이동
                        naverMap.setCenter(new naver.maps.LatLng(lat, lng));
                        
                        // 위치 정확도 표시
                        if (position.coords.accuracy) {
                            if (userLocationCircle) {
                                userLocationCircle.setMap(null);
                            }
                            
                            userLocationCircle = new naver.maps.Circle({
                                center: new naver.maps.LatLng(lat, lng),
                                radius: position.coords.accuracy,
                                strokeColor: '#4285F4',
                                strokeOpacity: 0.6,
                                strokeWeight: 1,
                                fillColor: '#4285F4',
                                fillOpacity: 0.2,
                                map: naverMap
                            });
                        }
                    }
                    
                    isTrackingUser = true;
                    updateGPSButton();
                },
                function(error) {
                    console.error('GPS 오류:', error);
                    let message = '';
                    
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            message = 'GPS 접근이 거부되었습니다. 브라우저 설정에서 위치 권한을 허용해주세요.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            message = 'GPS 정보를 가져올 수 없습니다.';
                            break;
                        case error.TIMEOUT:
                            message = 'GPS 요청 시간이 초과되었습니다.';
                            break;
                        default:
                            message = 'GPS 오류가 발생했습니다.';
                    }
                    
                    alert(message);
                    isTrackingUser = false;
                    updateGPSButton();
                },
                options
            );
        }
        
        updateGPSButton();
    }
    
    // 위치 추적 중지
    function stopLocationTracking() {
        if (userLocationWatchId) {
            navigator.geolocation.clearWatch(userLocationWatchId);
            userLocationWatchId = null;
        }
        
        if (userMarker) {
            userMarker.setMap(null);
            userMarker = null;
        }
        
        if (userLocationCircle) {
            userLocationCircle.setMap(null);
            userLocationCircle = null;
        }
        
        isTrackingUser = false;
        userLocation = null;
    }
    
    // GPS 버튼 상태 업데이트
    function updateGPSButton() {
        const gpsButton = document.querySelector('.gps-button');
        if (gpsButton) {
            if (isTrackingUser) {
                gpsButton.textContent = '⏹️';
                gpsButton.style.backgroundColor = '#4285F4';
                gpsButton.style.color = 'white';
                gpsButton.title = '위치 추적 중지';
            } else {
                gpsButton.textContent = '📍';
                gpsButton.style.backgroundColor = 'white';
                gpsButton.style.color = '#333';
                gpsButton.title = '현재 위치 표시';
            }
        }
    }
    
    // 건물 목록 렌더링
    function renderBuildingList() {
        const buildingList = document.querySelector('.building-list');
        if (!buildingList) return;
        
        buildingList.innerHTML = '';
        
        // 페이지네이션 계산
        const startIndex = (currentPage - 1) * buildingsPerPage;
        const endIndex = startIndex + buildingsPerPage;
        const currentBuildings = buildingData.slice(startIndex, endIndex);
        
        currentBuildings.forEach(building => {
            const listItem = document.createElement('li');
            listItem.className = 'building-item';
            
            listItem.innerHTML = `
                <div class="building-image">
                    <img src="${building.image}" alt="${building.name}">
                </div>
                <div class="building-info-container">
                    <div class="building-info">
                        <div class="building-name">${building.name}</div>
                        <div class="building-description">${building.description}</div>
                    </div>
                    <div class="building-nav-button" onclick="navigateToBuilding('${building.id}')">
                        <span>길찾기</span>
                        <span>🗺️</span>
                    </div>
                </div>
            `;
            
            // 클릭 이벤트 추가
            listItem.addEventListener('click', function(e) {
                if (!e.target.closest('.building-nav-button')) {
                    viewBuildingDetail(building.id);
                }
            });
            
            buildingList.appendChild(listItem);
        });
        
        // 페이지네이션 컨트롤 생성
        createPaginationControls();
    }
    
    // 페이지네이션 컨트롤 생성
    function createPaginationControls() {
        const paginationContainer = document.getElementById('pagination-controls');
        if (!paginationContainer) return;
        
        const totalPages = Math.ceil(buildingData.length / buildingsPerPage);
        paginationContainer.innerHTML = '';
        
        // 이전 버튼
        const prevButton = document.createElement('button');
        prevButton.className = 'pagination-button';
        prevButton.textContent = '이전';
        prevButton.disabled = currentPage === 1;
        prevButton.onclick = () => changePage(currentPage - 1);
        paginationContainer.appendChild(prevButton);
        
        // 페이지 번호 버튼
        for (let i = 1; i <= totalPages; i++) {
            const pageButton = document.createElement('button');
            pageButton.className = 'pagination-button';
            pageButton.textContent = i;
            
            if (i === currentPage) {
                pageButton.classList.add('active');
            }
            
            pageButton.onclick = () => changePage(i);
            paginationContainer.appendChild(pageButton);
        }
        
        // 다음 버튼
        const nextButton = document.createElement('button');
        nextButton.className = 'pagination-button';
        nextButton.textContent = '다음';
        nextButton.disabled = currentPage === totalPages;
        nextButton.onclick = () => changePage(currentPage + 1);
        paginationContainer.appendChild(nextButton);
    }
    
    // 페이지 변경
    function changePage(page) {
        const totalPages = Math.ceil(buildingData.length / buildingsPerPage);
        
        if (page < 1 || page > totalPages) return;
        
        currentPage = page;
        renderBuildingList();
    }
    
    // 건물로 길찾기
    function navigateToBuilding(buildingId) {
        if (!naverMap) {
            alert('지도를 먼저 로드해주세요.');
            return;
        }
        
        if (!userLocation) {
            trackUserLocation();
            setTimeout(() => {
                navigateToBuilding(buildingId);
            }, 2000);
            return;
        }
        
        const building = buildingData.find(b => b.id === buildingId);
        if (!building) return;
        
        console.log('길찾기 시작:', building.name);
        
        // 로딩 표시
        const loadingEl = document.getElementById('routeLoading');
        loadingEl.style.display = 'block';
        
        // Direction API 사용하여 경로 계산
        naver.maps.Service.route({
            mode: 'walking', // 도보 경로
            waypoints: [
                new naver.maps.LatLng(userLocation.lat, userLocation.lng),
                new naver.maps.LatLng(building.position.lat, building.position.lng)
            ]
        }, function(status, response) {
            loadingEl.style.display = 'none';
            
            if (status === naver.maps.Service.Status.OK) {
                console.log('경로 계산 성공');
                
                // 기존 경로 제거
                if (routePolyline) {
                    routePolyline.setMap(null);
                }
                
                // 새 경로 표시
                const route = response.result.path;
                routePolyline = new naver.maps.Polyline({
                    path: route,
                    strokeColor: '#c62917',
                    strokeWidth: 6,
                    strokeOpacity: 0.8,
                    strokeLineCap: 'round',
                    map: naverMap
                });
                
                // 경로 정보 표시
                showRouteInfo(response.result, building.name);
                
                // 경로에 맞게 지도 뷰 조정
                const bounds = new naver.maps.LatLngBounds();
                route.forEach(point => bounds.extend(point));
                naverMap.fitBounds(bounds, { padding: 50 });
                
            } else {
                console.error('경로 계산 실패:', status);
                alert('경로를 찾을 수 없습니다.');
            }
        });
    }
    
    // 경로 정보 표시
    function showRouteInfo(routeData, destinationName) {
        const infoBox = document.getElementById('routeInfoBox');
        const destinationEl = document.getElementById('routeDestination');
        const distanceEl = document.getElementById('routeDistance');
        const durationEl = document.getElementById('routeDuration');
        
        destinationEl.textContent = destinationName;
        distanceEl.textContent = `${routeData.distance}m`;
        durationEl.textContent = `${Math.ceil(routeData.duration / 60000)}분`;
        
        infoBox.style.display = 'block';
    }
    
    // 경로 정보 닫기
    function closeRouteInfo() {
        document.getElementById('routeInfoBox').style.display = 'none';
        
        if (routePolyline) {
            routePolyline.setMap(null);
            routePolyline = null;
        }
    }
    
    // 시설 검색 기능
    function searchFacilities(query) {
        const searchResults = document.getElementById('search-results');
        const noResults = document.getElementById('no-results');
        const originalContent = document.getElementById('original-content');
        const clearButton = document.querySelector('.search-clear');
        
        if (!query.trim()) {
            // 검색어가 비어있으면 원래 내용 표시
            searchResults.style.display = 'none';
            noResults.style.display = 'none';
            originalContent.style.display = 'block';
            clearButton.style.display = 'none';
            return;
        }
        
        // X 버튼 표시
        clearButton.style.display = 'block';
        
        // 검색 실행
        const filteredResults = buildingData.filter(building => 
            building.name.toLowerCase().includes(query.toLowerCase()) ||
            building.description.toLowerCase().includes(query.toLowerCase())
        );
        
        // 원래 내용 숨기기
        originalContent.style.display = 'none';
        
        if (filteredResults.length === 0) {
            // 검색 결과 없음
            searchResults.style.display = 'none';
            noResults.style.display = 'block';
        } else {
            // 검색 결과 표시
            noResults.style.display = 'none';
            searchResults.style.display = 'block';
            searchResults.innerHTML = '';
            
            filteredResults.forEach(building => {
                const resultItem = document.createElement('div');
                resultItem.className = 'building-item';
                resultItem.innerHTML = `
                    <div class="building-image">
                        <img src="${building.image}" alt="${building.name}">
                    </div>
                    <div class="building-info-container">
                        <div class="building-info">
                            <div class="building-name">${highlightQuery(building.name, query)}</div>
                            <div class="building-description">${highlightQuery(building.description, query)}</div>
                        </div>
                        <div class="building-nav-button" onclick="navigateToBuilding('${building.id}')">
                            <span>길찾기</span>
                            <span>🗺️</span>
                        </div>
                    </div>
                `;
                
                // 클릭 이벤트 추가
                resultItem.addEventListener('click', function(e) {
                    if (!e.target.closest('.building-nav-button')) {
                        viewBuildingDetail(building.id);
                    }
                });
                
                searchResults.appendChild(resultItem);
            });
        }
    }
    
    // 검색어 하이라이트
    function highlightQuery(text, query) {
        if (!query) return text;
        const regex = new RegExp(`(${query})`, 'gi');
        return text.replace(regex, '<span class="search-highlight">$1</span>');
    }
    
    // 검색 초기화
    function clearSearch() {
        const searchInput = document.getElementById('facility-search-input');
        searchInput.value = '';
        searchFacilities('');
    }
    
    // 빠른 검색
    function quickSearch(keyword) {
        const searchInput = document.getElementById('facility-search-input');
        searchInput.value = keyword;
        searchFacilities(keyword);
        
        // 빠른 검색 버튼 활성화 상태 변경
        const tags = document.querySelectorAll('.category-tag');
        tags.forEach(tag => tag.classList.remove('active'));
        event.target.classList.add('active');
    }
    
    // 검색 엔터키 처리
    function handleSearchKeyPress(event) {
        if (event.key === 'Enter') {
            // 엔터키 입력 시 검색 실행 (이미 oninput으로 처리됨)
            event.preventDefault();
        }
    }
    
    // 페이지 이동 함수들
    function goToPage(page) {
        if (page === 'timetable') {
            window.location.href = 'timetable.html';
        } else if (page === 'login') {
            window.location.href = 'login.html';
        } else if (page === 'profile-edit') {
            window.location.href = 'profile-edit.html';
        } else if (page === 'shutdown') {
            window.location.href = 'shutdown.html';
        } else if (page === 'welcome') {
            window.location.href = 'welcome.html';
        } else if (page === 'notices') {
            window.location.href = 'notices.html';
        } else {
            console.log(`페이지 이동: ${page}`);
        }
    }
    
    // 뒤로가기
    function goToHome() {
        switchTab('home');
    }
    
    // 로그아웃
    function logout() {
        if (confirm('로그아웃 하시겠습니까?')) {
            localStorage.removeItem('currentLoggedInUser');
            goToPage('shutdown');
        }
    }
    
    // 회원 탈퇴
    function deleteAccount() {
        if (confirm('정말로 회원 탈퇴를 하시겠습니까?\n모든 데이터가 삭제되고 복구할 수 없습니다.')) {
            const currentUser = localStorage.getItem('currentLoggedInUser');
            if (currentUser) {
                // 사용자 관련 모든 데이터 삭제
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.includes(`_user_${currentUser}`) || key.includes(`_${currentUser}`)) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => localStorage.removeItem(key));
                localStorage.removeItem('currentLoggedInUser');
                
                alert('회원 탈퇴가 완료되었습니다.');
                goToPage('welcome');
            }
        }
    }
    
    // 모든 설정 초기화
    function resetAllSettings() {
        if (confirm('모든 설정을 초기화하시겠습니까?\n이 작업은 되돌릴 수 없습니다.')) {
            const currentUser = localStorage.getItem('currentLoggedInUser');
            if (currentUser) {
                // 설정 관련 데이터만 삭제
                const settingsKeys = [
                    `settings_user_${currentUser}`,
                    `notifications_user_${currentUser}`,
                    `widgets_user_${currentUser}`
                ];
                
                settingsKeys.forEach(key => localStorage.removeItem(key));
                
                alert('모든 설정이 초기화되었습니다.');
                window.location.reload();
            }
        }
    }
    
    // 공지사항 관련 함수
    function viewNotification(notificationId) {
        console.log('알림 확인:', notificationId);
    }
    
    function goToNoticeDetail(noticeId) {
        if (noticeId === 'notice1') {
            window.location.href = `notice-detail.html?id=${noticeId}`;
        } else {
            // 다른 공지사항들은 간단한 알림만 표시
            alert('공지사항 상세 페이지는 준비 중입니다.');
        }
    }
    
    function filterNotices(category) {
        console.log('공지사항 필터:', category);
        
        // 카테고리 태그 활성화 상태 변경
        const tags = document.querySelectorAll('.category-tag');
        tags.forEach(tag => tag.classList.remove('active'));
        event.target.classList.add('active');
    }
    
    // 강의평가 관련 함수
    function filterLectures(category) {
        console.log('강의평가 필터:', category);
        
        // 카테고리 태그 활성화 상태 변경
        const tags = document.querySelectorAll('.category-tag');
        tags.forEach(tag => tag.classList.remove('active'));
        event.target.classList.add('active');
    }
    
    function viewLectureDetail(lectureId) {
        console.log('강의평가 상세:', lectureId);
        // 강의평가 상세 페이지로 이동하거나 모달 표시
    }
    
    // 내 정보 관련 함수
    function navigateToProfilePage(page) {
        if (page === 'timetable') {
            goToPage('timetable');
        } else {
            console.log('프로필 페이지 이동:', page);
        }
    }
    
    // 건물 상세 정보 보기
    function viewBuildingDetail(buildingId) {
        console.log('건물 상세:', buildingId);
        // 건물 상세 정보 모달 표시 또는 페이지 이동
    }
    
    // 편의시설 상세 정보 보기
    function showFacilityDetail(facilityId) {
        console.log('편의시설 상세:', facilityId);
        // 편의시설 상세 정보 모달 표시
    }
</script>
    </body>
</html>